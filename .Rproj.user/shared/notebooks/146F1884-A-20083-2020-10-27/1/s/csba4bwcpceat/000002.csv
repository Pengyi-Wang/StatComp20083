"0","f=function(n,m,mcv,Mcv,e){"
"0","  power=numeric(m)"
"0","  for(i in 1:m){"
"0","    sigmax=sample(c(1,10),replace = TRUE,size = n,prob = c(1-e, e))"
"0","    x=rnorm(n,0,sigmax)"
"0","    sigmay=sample(c(1,10),replace = TRUE,size = n,prob = c(1-e, e))"
"0","    y=rnorm(n,0,sigmay)"
"0","    covxy=cov(x,y)"
"0","    #power[i]=as.integer(n*sum((outer(x-mean(x),y-mean(y),""*"")/covxy)^3)/n^2/6<mcv)+as.integer(n*sum((outer(x-mean(x),y-mean(y),""*"")/covxy)^3)/n^2/6>Mcv)"
"0","    power[i]=as.integer(n*sum(((x-mean(x))*(y-mean(y))/covxy)^3)/n^2/6<mcv)+as.integer(n*sum(((x-mean(x))*(y-mean(y))/covxy)^3)/n^2/6>Mcv)"
"0","  }"
"0","  return(mean(power))"
"0","}"
"0","d=2"
"0","alpha=0.05"
"0","n=30"
"0","m=1000"
"0","epsilon=c(seq(0,.15,.01),seq(.15,1,.05))"
"0","mcv=qchisq(alpha/2,d*(d+1)*(d+2)/6)"
"0","Mcv=qchisq(1-alpha/2,d*(d+1)*(d+2)/6)"
"0","result=numeric(length(epsilon))"
"0","for(i in 1:length(epsilon)){"
"0","  result[i]=f(n,m,mcv,Mcv,epsilon[i])"
"0","}"
"0","plot(epsilon,result,type=""b"",xlab=bquote(epsilon),ylim=c(0,1))"
