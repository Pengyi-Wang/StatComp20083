"0","library(Rcpp)"
"0","set.seed(980904)"
"0","dir_cpp='../vignettes/'"
"0","sourceCpp(paste0(dir_cpp,""crw.cpp""))"
"2","path[1]=""E:/Rpack/StatComp20083/vignettes/../inst/include"": 系统找不到指定的文件。"
"0","rw.Metropolis=function(sigma, x0, N) {"
"0","    x=numeric(N)"
"0","    x[1]=x0"
"0","    u=runif(N)"
"0","    k=0"
"0","    for(i in 2:N){"
"0","        y=rnorm(1,x[i-1],sigma)"
"0","            if(u[i]<=((1/2*exp(-abs(y)))/(1/2*exp(-abs(x[i-1])))))"
"0","                x[i]=y  "
"0","            else{"
"0","                x[i]=x[i-1]"
"0","                k=k+1"
"0","            }"
"0","        }"
"0","    return(list(x=x,k=k))"
"0","}"
"0",""
"0","N=2000"
"0","sigma=c(.05,.5,2,16)"
"0",""
"0","x0=25"
"0","rw1=rw.Metropolis(sigma[1],x0,N)"
"0","rw2=rw.Metropolis(sigma[2],x0,N)"
"0","rw3=rw.Metropolis(sigma[3],x0,N)"
"0","rw4=rw.Metropolis(sigma[4],x0,N)"
"0",""
"0","crw1=crw(sigma[1],x0,N)"
"0","crw2=crw(sigma[2],x0,N)"
"0","crw3=crw(sigma[3],x0,N)"
"0","crw4=crw(sigma[4],x0,N)"
"0",""
"0","#number of candidate points rejected"
"0","no.reject=data.frame(sigma=sigma,no.reject=c(crw1$k,crw2$k,crw3$k,crw4$k))"
"0","knitr::kable(no.reject)"
