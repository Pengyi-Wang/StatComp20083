"0","maxout <- function(x, y) {"
"0","  X=x-mean(x)"
"0","  Y=y-mean(y)"
"0","  outx=sum(X>max(Y))+sum(X<min(Y))"
"0","  outy=sum(Y>max(X))+sum(Y<min(X))"
"0","  return(max(c(outx, outy)))"
"0","}"
"0","count5test=function(x,y,num){"
"0","  X=x-mean(x)"
"0","  Y=y-mean(y)"
"0","  outx=sum(X>max(Y))+sum(x<min(Y))"
"0","  outy=sum(Y>max(X))+sum(Y<min(X))"
"0","  # return 1 (reject) or 0 (do not reject H0)"
"0","  return(as.integer(max(c(outx, outy))>num))"
"0","}"
"0","n1=30"
"0","n2=50"
"0","m=1000"
"0","set.seed(980904)"
"0","stat <- replicate(m,expr={"
"0","x=rnorm(n1)"
"0","y=rnorm(n2)"
"0","maxout(x, y)"
"0","})"
"0","num=as.integer(quantile(stat, c(.95)))-1"
"0","B=1000"
"0","test=numeric(B)"
"0","for(i in 1:B){"
"0","  x=rnorm(n1);y=rnorm(n2)"
"0","  test[i]=count5test(x,y,num)"
"0","}"
"0","print(mean(test))"
"1","[1]"
"1"," 0.061"
"1","
"
