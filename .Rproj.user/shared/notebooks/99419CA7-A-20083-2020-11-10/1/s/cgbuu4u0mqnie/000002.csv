"0","library(boot)"
"0","library(RANN)"
"0","library(energy)"
"0","library(Ball)"
"0","Tn=function(z, ix, sizes,k){"
"0","n1=sizes[1];n2=sizes[2];n=n1+n2"
"0","if(is.vector(z))z=data.frame(z,0);"
"0","z=z[ix, ];"
"0","NN=nn2(data=z, k=k+1)"
"0","block1=NN$nn.idx[1:n1,-1]"
"0","block2=NN$nn.idx[(n1+1):n,-1]"
"0","i1=sum(block1<n1+.5);i2=sum(block2>n1+.5)"
"0","return((i1+i2)/(k*n))"
"0","}"
"0",""
"0","n=20"
"0","set.seed(980904)"
"0","x=matrix(rnorm(n*2),nrow=n,ncol=2)"
"0","y=matrix(rnorm(n*2,0,1.5),nrow=n,ncol=2)"
"0","z=rbind(x,y)"
"0","p.value=numeric(3)"
"0","N=c(nrow(x),nrow(y))"
"0",""
"0","boot.obj=boot(data=z,statistic=Tn,R=999,sim=""permutation"",sizes=N,k=3)"
"0","ts=c(boot.obj$t0,boot.obj$t)"
"0","p.value[1]=mean(ts>=ts[1])"
"0",""
"0","boot.obs=eqdist.etest(z,sizes=N,R=999)"
"0","p.value[2]=boot.obs$p.value"
"0",""
"0","p.value[3]=bd.test(x=x,y=y,R=999)$p.value"
"0",""
"0","print(p.value)"
"1","[1]"
"1"," 0.189"
"1"," 0.106"
"1"," 0.160"
"1","
"
