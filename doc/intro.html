<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Pengyi Wang" />

<meta name="date" content="2020-12-19" />

<title>Introduction to StatComp20083_HW</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to StatComp20083_HW</h1>
<h4 class="author">Pengyi Wang</h4>
<h4 class="date">2020-12-19</h4>



<div id="question" class="section level2">
<h2>Question</h2>
<p>1(3.3).The Pareto(a, b) distribution has cdf <span class="math display">\[\begin{align*}
F(x)=1−{(\frac{b}{x})}^{a},x≥b&gt;0,a&gt;0.
\end{align*}\]</span> Derive the probability inverse transformation <span class="math inline">\({F}^{−1}(U)\)</span> and use the inversetrans form method to simulate a random sample from the Pareto(2, 2) distribution. Graph the density histogram of the sample with the Pareto(2, 2) density superimposed for comparison.</p>
<p>2(3.9).The rescaled Epanechnikov kernel [85] is a symmetric density function <span class="math display">\[\begin{align*} f_e(x)=\frac{3}{4}(1−x^2),\qquad\left\vert a \right\vert≤1.\qquad\qquad\qquad (3.10) \end{align*}\]</span> Devroye and Gy<span class="math inline">\(\ddot{o}\)</span>rfi [71, p.236] give the following algorithm for simulation from this distribution. Generate iid <span class="math inline">\(U_1,U_2,U_3∼Uniform(−1,1)\)</span>. If<span class="math inline">\(\lvert U_3\rvert\ge\lvert U_2\rvert\ and\ \lvert U_3\rvert\ge\lvert U_1\rvert\)</span>, deliver <span class="math inline">\(U_2\)</span>; otherwise deliver <span class="math inline">\(U_3\)</span>. Write a function to generate random variates from <span class="math inline">\(f_e\)</span>, and construct the histogram density estimate of a large simulated random sample.</p>
<p>3(3.10).Prove that the algorithm given in Exercise 3.9 generates variates from the density <span class="math inline">\(f_e\)</span>(3.10).</p>
<p>4(3.13).It can be shown that the mixture in Exercise 3.12 has a Pareto distribution with cdf <span class="math display">\[\begin{align*}F(y)=1−(\frac{\beta}{\beta +y})^r,\quad y≥0.\end{align*}\]</span> (This is an alternative parameterization of the Pareto cdf given in Exercise 3.3.) Generate 1000 random observations from the mixture with r = 4 and <span class="math inline">\(\beta\)</span> = 2. Compare the empirical and theoretical (Pareto) distributions by graphing the density histogram of the sample and superimposing the Pareto densitycurve.</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p>answer 1</p>
<p>For <span class="math inline">\(F(x)=1−{(\frac{b}{x})}^a\)</span> we have the inverse function <span class="math inline">\(F^{-1}(u)=\frac{b}{(1-u)^\frac{1}{a}}\)</span> and its cdf <span class="math inline">\(f(x)=\frac{ab^a}{x^{a+1}}\)</span>.</p>
<p>Then we can take a=2 and b=2 from the question, and get 1000 uniformly distributed random numbers by R.</p>
<p>And use the inverse function <span class="math inline">\(x=F^{-1}(u)=\frac{2}{(1-u)^\frac{1}{2}}\)</span>, we can get 1000 random numbers about x.</p>
<p>The last, draw the graph that the question ask</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>a=b=<span class="dv">2</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">set.seed</span>(<span class="dv">980904</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a>n=<span class="dv">1000</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>u=<span class="kw">runif</span>(n)</span>
<span id="cb1-5"><a href="#cb1-5"></a>x=b<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>u)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>a)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="kw">hist</span>(x, <span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">breaks=</span><span class="kw">seq</span>(b,<span class="kw">max</span>(x)<span class="op">+</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span>a<span class="op">*</span>b<span class="op">^</span>a<span class="op">/</span>x<span class="op">^</span>(a<span class="op">+</span><span class="dv">1</span>)))</span>
<span id="cb1-7"><a href="#cb1-7"></a>y=<span class="kw">seq</span>(b,<span class="kw">max</span>(x)<span class="op">+</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="kw">lines</span>(y,(a<span class="op">*</span>b<span class="op">^</span>a)<span class="op">/</span>(y<span class="op">^</span>(a<span class="op">+</span><span class="dv">1</span>)))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>answer 2</p>
<p>By the algorithm that the question gave us, we can easily write R program to achieve the question requirements.</p>
<p>And We’ll prove it in the next problem.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>n=<span class="dv">10000</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw">set.seed</span>(<span class="dv">98</span>)</span>
<span id="cb2-3"><a href="#cb2-3"></a>u1=<span class="kw">runif</span>(n,<span class="dt">min=</span><span class="op">-</span><span class="dv">1</span>,<span class="dt">max=</span><span class="dv">1</span>)</span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="kw">set.seed</span>(<span class="dv">09</span>)</span>
<span id="cb2-5"><a href="#cb2-5"></a>u2=<span class="kw">runif</span>(n,<span class="dt">min=</span><span class="op">-</span><span class="dv">1</span>,<span class="dt">max=</span><span class="dv">1</span>)</span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="kw">set.seed</span>(<span class="dv">04</span>)</span>
<span id="cb2-7"><a href="#cb2-7"></a>u3=<span class="kw">runif</span>(n,<span class="dt">min=</span><span class="op">-</span><span class="dv">1</span>,<span class="dt">max=</span><span class="dv">1</span>)</span>
<span id="cb2-8"><a href="#cb2-8"></a>x=<span class="dv">1</span><span class="op">:</span>n</span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n)</span>
<span id="cb2-10"><a href="#cb2-10"></a>{</span>
<span id="cb2-11"><a href="#cb2-11"></a>  <span class="cf">if</span>(<span class="kw">abs</span>(u3[i])<span class="op">&gt;=</span><span class="kw">abs</span>(u1[i])<span class="op">&amp;</span><span class="kw">abs</span>(u3[i])<span class="op">&gt;=</span><span class="kw">abs</span>(u2[i])){x[i]=u2[i]} <span class="cf">else</span>{x[i]=u3[i]}</span>
<span id="cb2-12"><a href="#cb2-12"></a>}</span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="kw">hist</span>(x, <span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,.<span class="dv">01</span>), <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span><span class="dv">3</span><span class="op">/</span><span class="dv">4</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x<span class="op">^</span><span class="dv">2</span>)))</span>
<span id="cb2-14"><a href="#cb2-14"></a>y=<span class="kw">seq</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,.<span class="dv">01</span>)</span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="kw">lines</span>(y,<span class="dv">3</span><span class="op">/</span><span class="dv">4</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>y<span class="op">^</span><span class="dv">2</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>answer 3</p>
<p>In the question, we can figure out its distribution function and then we can take the derivative of the distribution function. By comparing the probability density functions of them complete proof. <span class="math display">\[\begin{align*}
F(x)&amp;=P(X\le x)=(\iiint_{(U_2\le x, \lvert U_3\rvert\ge\lvert U_2\rvert,\lvert U_3\rvert\ge\lvert U_1\rvert)}+\iiint_{(U_3\le x,\lvert U_3\rvert&lt;\lvert U_2\rvert\ or\ \lvert U_3\rvert&lt;\lvert U_1\rvert)})\frac{1}{8}dU_1dU_2dU_3 \\
&amp;=[(\iiint_{(U_2\le x,\lvert U_2\rvert\ge\lvert U_1\rvert,\lvert U_3\rvert\ge\lvert U_2\rvert)}+\iiint_{(U_2\le x, \lvert U_1\rvert\ge\lvert U_2\rvert,\lvert U_3\rvert\ge\lvert U_1\rvert)})+\iiint_{(U_3\le x,\lvert U_3\rvert&lt;\lvert U_2\rvert\ or\ \lvert U_3\rvert&lt;\lvert U_1\rvert)})]\frac{1}{8}dU_1dU_2dU_3 \\
&amp;=[\int_{-1}^x\int_{-\lvert U_2\rvert}^{\lvert U_2\rvert}\int_{-\lvert U_2\rvert}^{\lvert U_2\rvert}+\int_{-1}^x(\int_{\lvert U_2\rvert}^1 +\int_{-1}^{-\lvert U_2\rvert})(\int_{\lvert U_1\rvert}^1 +\int_{-1}^{-\lvert U_1\rvert})]\frac{1}{8}dU_3dU_1dU_2 + \int_{-1}^x(4-\iint_{\lvert U_3\rvert\ge\lvert U_2\rvert, \lvert U_3\rvert\ge\lvert U_1\rvert})\frac{1}{8}dU_1dU_2dU_3 \\
&amp;=\int_{-1}^x\frac{1}{4}-\frac{1}{4}U_2^2dU_2 + \int_{-1}^x\frac{1}{2}-\frac{1}{2}U_3^2dU_3 \\
&amp;=\frac{3}{4}x-\frac{1}{4}x^3+\frac{1}{2} \\
\end{align*}\]</span> Its cdf is <span class="math inline">\(f(x)=F&#39;(x)=\frac{3}{4}(1-x^2)\)</span></p>
<p>This is all</p>
<p>answer 4</p>
<p>For <span class="math inline">\(F(y)=1−{(\frac{\beta}{\beta+y})}^r\)</span> we have the inverse function <span class="math inline">\(F^{-1}(u)=\frac{\beta}{(1-u)^\frac{1}{r}}-\beta\)</span> and its cdf <span class="math inline">\(f(y)=\frac{r\beta^r}{(\beta+y)^{r+1}}\)</span>.</p>
<p>Then we can take <span class="math inline">\(\beta=2\)</span> and r=4 from the question, and get 1000 uniformly distributed random numbers by R.</p>
<p>And use the inverse function <span class="math inline">\(y=F^{-1}(u)=\frac{\beta}{(1-u)^\frac{1}{r}}-\beta\)</span>, we can get 1000 random numbers about y.</p>
<p>The last, draw the graph that the question ask</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>r=<span class="dv">4</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>b=<span class="dv">2</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="kw">set.seed</span>(<span class="dv">980904</span>)</span>
<span id="cb3-4"><a href="#cb3-4"></a>n=<span class="dv">1000</span></span>
<span id="cb3-5"><a href="#cb3-5"></a>u=<span class="kw">runif</span>(n)</span>
<span id="cb3-6"><a href="#cb3-6"></a>y=b<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>u)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>r)<span class="op">-</span>b</span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="kw">hist</span>(y, <span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">breaks=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="kw">max</span>(y)<span class="op">+</span><span class="dv">1</span>,.<span class="dv">1</span>), <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(y)<span class="op">==</span>r<span class="op">*</span>b<span class="op">^</span>r<span class="op">/</span>(b<span class="op">+</span>y)<span class="op">^</span>(r<span class="op">+</span><span class="dv">1</span>)))</span>
<span id="cb3-8"><a href="#cb3-8"></a>x=<span class="kw">seq</span>(<span class="dv">0</span>,<span class="kw">max</span>(y)<span class="op">+</span><span class="dv">1</span>,.<span class="dv">1</span>)</span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="kw">lines</span>(x,(r<span class="op">*</span>b<span class="op">^</span>r)<span class="op">/</span>((b<span class="op">+</span>x)<span class="op">^</span>(r<span class="op">+</span><span class="dv">1</span>)))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p>1(5.1).Compute a Monte Carlo estimate of <span class="math display">\[\begin{align*}
\int_{0}^{\frac{\pi}{3}}\sin tdt
\end{align*}\]</span> and compare your estimate with the exact value of the integral.</p>
<p>2(5.7).Refer to Exercise 5.6. Use Monte Carlo simulation to estimate <span class="math inline">\(\theta\)</span> by the antithetic variate approach and by the simple Monte Carlo method. Compute an empirical estimate of the percent reduction in variance using the antithetic variate. Compare the result with the theoretical value from Exercise 5.6</p>
<p>3(5.11).If <span class="math inline">\(\hat\theta_1\)</span> and <span class="math inline">\(\hat\theta_2\)</span> unbiased estimators of <span class="math inline">\(\theta\)</span>, and <span class="math inline">\(\hat\theta_1\)</span> and <span class="math inline">\(\hat\theta_2\)</span> are antithetic, we derived that <span class="math inline">\(c^*\)</span>=1/2 is the optimal constant that minimizes the variance of <span class="math inline">\(\hat\theta_c=c\hat\theta_1+(1-c)\hat\theta_2\)</span>. Derive <span class="math inline">\(c^*\)</span> for the general case. That is, if <span class="math inline">\(\hat\theta_1\)</span> and <span class="math inline">\(\hat\theta_2\)</span> are any two unbiased estimators of <span class="math inline">\(\theta\)</span>, find the value <span class="math inline">\(c^*\)</span> that minimizes the variance of the estimator <span class="math inline">\(\hat\theta_c=c\hat\theta_1+(1-c)\hat\theta_2\)</span> in equation(5.11). (<span class="math inline">\(c^*\)</span> will be a function of the variances and the covariance of the estimators)</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<p>Answer 1</p>
<p>Solving the integral, we can get the exact value about it:</p>
<p><span class="math display">\[\int_{0}^{\frac{\pi}{3}}\sin tdt=-(\cos \frac{\pi}{3}-\cos 0)=\frac 1 2 .\]</span></p>
<p>For using Compute a Monte Carlo estimate, we need change ti form:</p>
<p><span class="math display">\[\int_{0}^{\frac{\pi}{3}}\sin tdt=\int_{0}^{\frac{\pi}{3}}(\frac{\pi}{3}\sin t)\frac{3}{\pi}dt=E[\frac{\pi}{3}\sin t].\]</span></p>
<p>So we can get the <span class="math inline">\(g(x)=\frac{\pi}{3}\sin x\)</span> and <span class="math inline">\(X\sim U(0,\frac{\pi}{3})\)</span>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>pi=<span class="fl">3.141592654</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="kw">set.seed</span>(<span class="dv">980904</span>)</span>
<span id="cb4-3"><a href="#cb4-3"></a>n=<span class="fl">1e4</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>u=<span class="kw">runif</span>(n,<span class="dt">min=</span><span class="dv">0</span>,<span class="dt">max=</span>pi<span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb4-5"><a href="#cb4-5"></a>answer=<span class="kw">mean</span>(pi<span class="op">/</span><span class="dv">3</span><span class="op">*</span><span class="kw">sin</span>(u))</span>
<span id="cb4-6"><a href="#cb4-6"></a>answer.sd=<span class="kw">sd</span>(pi<span class="op">/</span><span class="dv">3</span><span class="op">*</span><span class="kw">sin</span>(u))<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="kw">print</span>(<span class="kw">c</span>(answer,<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>,(answer<span class="dv">-1</span><span class="op">/</span><span class="dv">2</span>)<span class="op">/</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>),<span class="kw">round</span>(<span class="kw">c</span>(answer<span class="fl">-1.96</span><span class="op">*</span>answer.sd,answer<span class="fl">+1.96</span><span class="op">*</span>answer.sd),<span class="dv">6</span>)))</span></code></pre></div>
<pre><code>## [1] 0.502662736 0.500000000 0.005325471 0.497432000 0.507893000</code></pre>
<p>we can find its error is small.</p>
<p>Answer 2</p>
<p>First compute the theoretical value: <span class="math display">\[\theta=\int_0^1 e^xdx\]</span> <span class="math display">\[Var(e^U)=E(e^{2U})-(E(e^U))^2=\int_0^1 e^{2x}dx-(\int_0^1 e^{x}dx)^2=\frac{1}{2}(e^2-1)-(e-1)^2=0.2420\]</span> <span class="math display">\[Cov(e^U,e^{1-U})=E(e^{U+1-U)})-E(e^U)E(e^{1-U})=e-\int_0^1e^xdx \int_0^1e^{1-x}dx=-0.2342\]</span> <span class="math display">\[Var((e^U+e^{1-U})/2)=Var(e^U)/4+Var(e^{1-U})/4+Cov(e^U,e^{1-U})/2=0.0039\]</span> <span class="math display">\[\frac{Var(e^U)-Var((e^U+e^{1-U})/2)}{Var(e^U)}=(0.2420-0.0039)/0.2420=0.9839\]</span></p>
<p>Then wo can compute its empirical estimate by R:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>n=<span class="dv">10000</span>;</span>
<span id="cb6-2"><a href="#cb6-2"></a>x1=<span class="kw">runif</span>(n,<span class="dt">min=</span><span class="dv">0</span>,<span class="dt">max=</span><span class="dv">1</span>)</span>
<span id="cb6-3"><a href="#cb6-3"></a>x2=<span class="kw">runif</span>(n<span class="op">/</span><span class="dv">2</span>,<span class="dt">min=</span><span class="dv">0</span>,<span class="dt">max=</span><span class="dv">1</span>)</span>
<span id="cb6-4"><a href="#cb6-4"></a>T_V=<span class="fl">0.9839</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">var</span>(<span class="kw">exp</span>(x1)),<span class="kw">var</span>(<span class="kw">c</span>((<span class="kw">exp</span>(x2)<span class="op">+</span><span class="kw">exp</span>(<span class="dv">1</span><span class="op">-</span>x2))<span class="op">/</span><span class="dv">2</span>)),(<span class="kw">var</span>(<span class="kw">exp</span>(x1))<span class="op">-</span><span class="kw">var</span>(<span class="kw">c</span>((<span class="kw">exp</span>(x2)<span class="op">+</span><span class="kw">exp</span>(<span class="dv">1</span><span class="op">-</span>x2))<span class="op">/</span><span class="dv">2</span>)))<span class="op">/</span><span class="kw">var</span>(<span class="kw">exp</span>(x1)),T_V ) )</span></code></pre></div>
<pre><code>## [1] 0.239993828 0.003949372 0.983543861 0.983900000</code></pre>
<p>the 3rd is an empirical estimate, the 4th is the theoretical value.</p>
<p>Answer 3</p>
<p>Solution:</p>
<p>First <span class="math inline">\(Var(c\hat\theta_1+(1-c)\hat\theta_2)=Var(\hat{\theta}_2)+c^2Var(\hat{\theta}_1-\hat{\theta}_2)+2cCov(\hat{\theta}_2,\hat{\theta}_1-\hat{\theta}_2)\)</span></p>
<p>Let’s <span class="math inline">\(f(c)=Var(\hat{\theta}_2)+c^2Var(\hat{\theta}_1-\hat{\theta}_2)+2cCov(\hat{\theta}_2,\hat{\theta}_1-\hat{\theta}_2)\)</span></p>
<p>So, <span class="math inline">\(f(c)=Var(\hat{\theta}_1-\hat{\theta}_2)(c+\frac{Cov(\hat{\theta}_2,\hat{\theta}_1-\hat{\theta}_2)}{Var(\hat{\theta}_1-\hat{\theta}_2)})^2-\frac{(Cov(\hat{\theta}_2,\hat{\theta}_1-\hat{\theta}_2))^2}{Var(\hat{\theta}_1-\hat{\theta}_2)}\)</span></p>
<p>New, we can find the min of f(c) is <span class="math inline">\(-\frac{(Cov(\hat{\theta}_2,\hat{\theta}_1-\hat{\theta}_2))^2}{Var(\hat{\theta}_1-\hat{\theta}_2)}\)</span> when c=<span class="math inline">\(-\frac{Cov(\hat{\theta}_2,\hat{\theta}_1-\hat{\theta}_2)}{Var(\hat{\theta}_1-\hat{\theta}_2)}\)</span></p>
<p>Therefore we get the general case about <span class="math inline">\(c^*\)</span>, <span class="math inline">\(c^*=-\frac{Cov(\hat{\theta}_2,\hat{\theta}_1-\hat{\theta}_2)}{Var(\hat{\theta}_1-\hat{\theta}_2)}\)</span></p>
</div>
<div id="question-2" class="section level2">
<h2>Question</h2>
<p>1(5.13).Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1,\infty)\)</span> and are ‘close’ to <span class="math display">\[\begin{align*}
g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2},\qquad x&gt;1
\end{align*}\]</span> Which of your two importance functions should produce the smaller variance in estimating <span class="math display">\[\begin{align*}
\int_1^{\infty} \frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx
\end{align*}\]</span> by importance sampling? Explain.</p>
<p>2(5.15).Obtain the stratified importance sampling estimate in Example 5.13 and compare it with result of Example 5.10.</p>
<p>3(6.4).Suppose that <span class="math inline">\(X_1,...,X_n\)</span> are a random sample from a from a lognormal distribution with unknown parameters. Construct a 95% confidence interval for the parameter <span class="math inline">\(\mu\)</span>. Use a Monte Carlo method to obtain an empirical estimate of the confidence level.</p>
<p>4(6.5)Suppose a 95% symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^2(2)\)</span> data with sample size n=20. Compare your t-interval results with the simulation results in Example 6.4.(The t-interval should be more robust to departures from normality that the interval for variance)</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<p>Answer 1</p>
<p>Consider <span class="math inline">\(f_1(x)=\frac{1}{3}x^3e^{-\frac{x^2}{2}+\frac 1 2}\)</span> and <span class="math inline">\(f_2(x)=xe^{-\frac{x^2}{2}+\frac{1}{2}}\)</span> to ‘close’ the <span class="math inline">\(g(x)\)</span>.</p>
<p>Get 2 estimates: <span class="math inline">\(\hat\theta_1\)</span> and <span class="math inline">\(\hat\theta_1\)</span>: <span class="math display">\[\hat\theta_1=\frac{1}{n}\sum_{i=1}^n \frac{g(X_i)}{f_1(X_i)}\]</span> <span class="math display">\[\hat\theta_2=\frac{1}{n}\sum_{i=1}^n \frac{g(X_i)}{f_2(X_i)}\]</span></p>
<p>and <span class="math display">\[Var{(\hat\theta_1)}=\frac{Var{(\frac{g(X_1)}{f_1(X_1)})}}{n}=\frac{9}{2ne\pi}Var({\frac{1}{x}})=\frac{9}{2ne\pi}[E({\frac{1}{x^2}})-{(E({\frac{1}{x}}))}^2]\]</span> So <span class="math inline">\(Var{(\hat\theta_1)}=\frac{1}{2ne\pi}[\int_1^{\infty}3xe^{-\frac{x^2}{2}+\frac{1}{2}}dx-(\int_1^{\infty}x^2e^{-\frac{x^2}{2}+\frac{1}{2}}dx)^2]\)</span></p>
<p>Then <span class="math display">\[Var{(\hat\theta_2)}=\frac{Var{(\frac{g(X_1)}{f_2(X_1)})}}{n}=\frac{1}{2ne\pi}Var(x)=\frac{1}{2ne\pi}[Ex^2-(Ex)^2]\]</span> So <span class="math inline">\(Var{(\hat\theta_2)}=\frac{1}{2ne\pi}[\int_1^{\infty}x^3e^{-\frac{x^2}{2}+\frac{1}{2}}dx-(\int_1^{\infty}x^2e^{-\frac{x^2}{2}+\frac{1}{2}}dx)^2]\)</span></p>
<p>Therefore <span class="math inline">\(Var{(\hat\theta_1)}-Var{(\hat\theta_2)}=\frac{1}{2ne\pi}[\int_1^{\infty}3xe^{-\frac{x^2}{2}+\frac{1}{2}}dx-\int_1^{\infty}x^3e^{-\frac{x^2}{2}+\frac{1}{2}}dx]=0\)</span></p>
<p>Finally we can find the two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> have equal variance.</p>
<p>Answer 2</p>
<p>we want to estimate <span class="math inline">\(\int_0^1g(x)dx=\int_0^1\frac{e^{-x}}{1+x^2}dx\)</span> and use stratified sampling methods.</p>
<p>First, the integration can be written as <span class="math inline">\(\int_0^1g(x)dx=\sum_{j=1}^5\int_{(j-1)/5}^{j/5}g(x)dx\)</span>, and we konw the best important function is <span class="math inline">\(f_3(x)=\frac{e^{-x}}{1-e^{-1}}\)</span>.</p>
<p>So we consider <span class="math inline">\(f_{3j}(x)=\frac{e^{-x}}{e^{-\frac{j-1}{5}}-e^{-\frac{j}{5}}}\)</span> to use stratified sampling methods.</p>
<p>So <span class="math inline">\(\int_0^1g(x)dx=\sum_{j=1}^5\int_{(j-1)/5}^{j/5}\frac{g(x)}{f_{3j}(x)}f_{3j}(x)dx=\sum_{j=1}^5E[\frac{g(X)}{f_{3j}(X)}]\)</span> where the x’s pdf is f_{3j}(x).</p>
<p>Finally we can estimate it by R.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>m=<span class="dv">10000</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>n=<span class="dv">5</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>N=<span class="dv">50</span></span>
<span id="cb8-4"><a href="#cb8-4"></a>theta.hat=<span class="kw">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>)</span>
<span id="cb8-5"><a href="#cb8-5"></a>theta.hatj=<span class="kw">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb8-6"><a href="#cb8-6"></a>g=<span class="cf">function</span>(x){(<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>))<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">0</span>)<span class="op">*</span>(x<span class="op">&lt;</span><span class="dv">1</span>)}</span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">50</span>){</span>
<span id="cb8-8"><a href="#cb8-8"></a>  u=<span class="kw">runif</span>(m)    </span>
<span id="cb8-9"><a href="#cb8-9"></a>  x=<span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</span>
<span id="cb8-10"><a href="#cb8-10"></a>  fg=<span class="kw">g</span>(x)<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</span>
<span id="cb8-11"><a href="#cb8-11"></a>  theta.hat[i,<span class="dv">1</span>]=<span class="kw">mean</span>(fg)</span>
<span id="cb8-12"><a href="#cb8-12"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb8-13"><a href="#cb8-13"></a>    u=<span class="kw">runif</span>(m<span class="op">/</span>n,<span class="dt">min=</span>(j<span class="dv">-1</span>)<span class="op">/</span><span class="dv">5</span>,<span class="dt">max=</span>j<span class="op">/</span><span class="dv">5</span>)</span>
<span id="cb8-14"><a href="#cb8-14"></a>    x=<span class="op">-</span><span class="kw">log</span>(<span class="kw">exp</span>(<span class="op">-</span>(j<span class="dv">-1</span>)<span class="op">/</span><span class="dv">5</span>)<span class="op">-</span>u<span class="op">*</span>(<span class="kw">exp</span>(<span class="op">-</span>(j<span class="dv">-1</span>)<span class="op">/</span><span class="dv">5</span>)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>j<span class="op">/</span><span class="dv">5</span>)))</span>
<span id="cb8-15"><a href="#cb8-15"></a>    fg=<span class="kw">g</span>(x)<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span>(j<span class="dv">-1</span>)<span class="op">/</span><span class="dv">5</span>)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>j<span class="op">/</span><span class="dv">5</span>)))</span>
<span id="cb8-16"><a href="#cb8-16"></a>    theta.hatj[j]=<span class="kw">mean</span>(fg)</span>
<span id="cb8-17"><a href="#cb8-17"></a>  }</span>
<span id="cb8-18"><a href="#cb8-18"></a>  theta.hat[i,<span class="dv">2</span>]=<span class="kw">sum</span>(theta.hatj)</span>
<span id="cb8-19"><a href="#cb8-19"></a>}</span>
<span id="cb8-20"><a href="#cb8-20"></a><span class="kw">apply</span>(theta.hat,<span class="dv">2</span>,mean)</span></code></pre></div>
<pre><code>## [1] 0.5251447 0.5242266</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">apply</span>(theta.hat,<span class="dv">2</span>,sd)</span></code></pre></div>
<pre><code>## [1] 9.240145e-04 2.973977e-05</code></pre>
<p>the frist one is the important samlping estimate’s, the other one is the question’s method.</p>
<p>Answer 3</p>
<p>First, we know <span class="math inline">\(\ln X_i \sim N(\mu,\sigma^2)\)</span>. So the Cl of the parameter <span class="math inline">\(\mu\)</span> is <span class="math inline">\((\bar{X}_{\mu}-t_{1-\alpha/2}(n-1)\frac{S_{n_{\mu}}}{\sqrt n},\bar{X}_{\mu}+t_{1-\alpha/2}(n-1)\frac{S_{n_{\mu}}}{\sqrt n})\)</span> where <span class="math inline">\(\bar{X}_{\mu}=\frac{1}{n}\sum_{i=1}^{n}\ln X_i\)</span> and <span class="math inline">\(S_{n_{\mu}}=\frac{1}{m}\sum_{i=1}^n (lnX_i-\bar{X}_{\mu})^2\)</span>, and the 95% confidence interval is <span class="math inline">\(\alpha=0.95\)</span>. now, we assume <span class="math inline">\(\mu=0\)</span> and <span class="math inline">\(\sigma=1\)</span> to achieve the final question.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>n=<span class="dv">1000</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>m=<span class="dv">1000</span></span>
<span id="cb12-3"><a href="#cb12-3"></a>alpha=<span class="fl">0.05</span></span>
<span id="cb12-4"><a href="#cb12-4"></a>theta1=theta2=<span class="kw">numeric</span>(n)</span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb12-6"><a href="#cb12-6"></a>  x=<span class="kw">exp</span>(<span class="kw">rnorm</span>(m))</span>
<span id="cb12-7"><a href="#cb12-7"></a>  theta1[i]=<span class="kw">mean</span>(<span class="kw">log</span>(x))<span class="op">-</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,<span class="dt">df=</span>m<span class="dv">-1</span>)<span class="op">/</span><span class="kw">sqrt</span>(m)<span class="op">*</span><span class="kw">var</span>(<span class="kw">log</span>(x))</span>
<span id="cb12-8"><a href="#cb12-8"></a>  theta2[i]=<span class="kw">mean</span>(<span class="kw">log</span>(x))<span class="op">+</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,<span class="dt">df=</span>m<span class="dv">-1</span>)<span class="op">/</span><span class="kw">sqrt</span>(m)<span class="op">*</span><span class="kw">var</span>(<span class="kw">log</span>(x))  </span>
<span id="cb12-9"><a href="#cb12-9"></a>}</span>
<span id="cb12-10"><a href="#cb12-10"></a><span class="kw">print</span>(<span class="kw">mean</span>((theta1<span class="op">&lt;</span><span class="dv">0</span>)<span class="op">*</span>(<span class="dv">0</span><span class="op">&lt;</span>theta2)))</span></code></pre></div>
<pre><code>## [1] 0.952</code></pre>
<p>we can find the answer less than 0.95.</p>
<p>Answer 4</p>
<p>we can get the Cl of <span class="math inline">\(\chi^2(2)\)</span> is <span class="math inline">\((\frac1{20}\sum_{i=1}^{20}X_i-\frac{\chi^2(40)}{20},\frac1{20}\sum_{i=1}^{20}X_i+\frac{\chi^2(40)}{20})\)</span> when sample m=20 and we can answer the question by using MC</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>n=<span class="dv">10000</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>m=<span class="dv">20</span></span>
<span id="cb14-3"><a href="#cb14-3"></a>alpha=.<span class="dv">05</span></span>
<span id="cb14-4"><a href="#cb14-4"></a>UCL=theta1=theta2=<span class="kw">numeric</span>(n)</span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb14-6"><a href="#cb14-6"></a>  x1=<span class="kw">rnorm</span>(m,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">2</span>)</span>
<span id="cb14-7"><a href="#cb14-7"></a>  UCL[i]=(m<span class="dv">-1</span>)<span class="op">*</span><span class="kw">var</span>(x1)<span class="op">/</span><span class="kw">qchisq</span>(alpha,<span class="dt">df=</span>m<span class="dv">-1</span>)</span>
<span id="cb14-8"><a href="#cb14-8"></a>  x2=<span class="kw">rchisq</span>(m,<span class="dv">2</span>)</span>
<span id="cb14-9"><a href="#cb14-9"></a>  theta1[i]=<span class="kw">mean</span>(x2)<span class="op">-</span><span class="kw">qchisq</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,<span class="dt">df=</span><span class="dv">2</span><span class="op">*</span>m)<span class="op">/</span>m</span>
<span id="cb14-10"><a href="#cb14-10"></a>  theta2[i]=<span class="kw">mean</span>(x2)<span class="op">+</span><span class="kw">qchisq</span>(alpha<span class="op">/</span><span class="dv">2</span>,<span class="dt">df=</span><span class="dv">2</span><span class="op">*</span>m)<span class="op">/</span>m </span>
<span id="cb14-11"><a href="#cb14-11"></a>}</span>
<span id="cb14-12"><a href="#cb14-12"></a><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>((UCL<span class="op">&gt;</span><span class="dv">4</span>)),<span class="kw">mean</span>((theta1<span class="op">&lt;</span><span class="dv">2</span>)<span class="op">*</span>(<span class="dv">2</span><span class="op">&lt;</span>theta2))))</span></code></pre></div>
<pre><code>## [1] 0.948 1.000</code></pre>
</div>
<div id="question-3" class="section level2">
<h2>Question</h2>
<p>1(6.7).Estimate the power of the skewness test of normality against symmetric <span class="math inline">\(Beta(\alpha,\alpha)\)</span> distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as <span class="math inline">\(t(v)\)</span>?</p>
<p>2(6.8).Refer to Example 6.16. Repeat the simulation, but also compute the F test of equal variance, at significance level <span class="math inline">\(\hat{\alpha}\dot{=}0.055\)</span> Compare the power of the Count Five test and F test for small, medium, and large Sample sizes. (Recall that the F test is not applicable for non-normal distributions)</p>
<p>3(6.C).Repeat Examples 6.8 and 6.10 for Mardia’s multivariate skewness test. Mardia [187] proposed tests of multivariate normality based on multivariate generalizations of skewness and kurtosis. If X and Y are iid, the multivariate population skewness <span class="math inline">\(\beta_{1,d}\)</span> is defined by Mardia as <span class="math display">\[\begin{align*}
\beta_{1,d}=E[(x-\mu)^T\sum^{-1}(Y-\mu)]^3
\end{align*}\]</span> Under normality, <span class="math inline">\(\beta_{1,d}\)</span>=0. The multivariate skewness statistic is <span class="math display">\[\begin{align*}
$\beta_{1,d}$=\frac{1}{n^2}\sum^n_{i,j=1}((X_i-\bar{X})^T\hat{\sum}^{-1}(X_j-\bar{X}))^3
\end{align*}\]</span> where <span class="math inline">\(\hat{\sum}\)</span> is the maximum likelihood estimator of covariance. Lagre values of <span class="math inline">\(b_{1,d}\)</span> are significant. The asymptotic distribution of <span class="math inline">\(nb_{1,d}/6\)</span> is chisquared with <span class="math inline">\(d(d+1)(d+2)/6\)</span> degress of freedom.</p>
<p>4(Discussion)If we obtain the powers for two powers for two methods under a particular simulation setting with 10000 experiments: say, 0.651 for one method and 0.676 for another method. Can we say the powers are different at 0.05 level.</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<p>Answer 1</p>
<table>
<thead>
<tr class="header">
<th align="right">sample</th>
<th align="right">beta1</th>
<th align="right">beta2</th>
<th align="right">beta3</th>
<th align="right">beta4</th>
<th align="right">beta5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">10</td>
<td align="right">0.018</td>
<td align="right">0.010</td>
<td align="right">0.029</td>
<td align="right">0.035</td>
<td align="right">0.039</td>
</tr>
<tr class="even">
<td align="right">20</td>
<td align="right">0.007</td>
<td align="right">0.007</td>
<td align="right">0.012</td>
<td align="right">0.021</td>
<td align="right">0.014</td>
</tr>
<tr class="odd">
<td align="right">30</td>
<td align="right">0.002</td>
<td align="right">0.010</td>
<td align="right">0.011</td>
<td align="right">0.013</td>
<td align="right">0.009</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">0.000</td>
<td align="right">0.003</td>
<td align="right">0.004</td>
<td align="right">0.006</td>
<td align="right">0.010</td>
</tr>
<tr class="odd">
<td align="right">100</td>
<td align="right">0.001</td>
<td align="right">0.000</td>
<td align="right">0.002</td>
<td align="right">0.006</td>
<td align="right">0.011</td>
</tr>
</tbody>
</table>
<p>The betai in the figure above takes the parameter <span class="math inline">\(\alpha=i\)</span> We can find that the power reduces with the increase of sample size. when <span class="math inline">\(\alpha\)</span> increases, power also increases. Looking at the overall, we can find the power is small, so We have a very high probability of accepting the null hypothesis.</p>
<p>Now, we consider the t(v): choose T distribution and select n= 1,2,3,4,5 in t (n), consider sample is 10, 20, 30, 50 or 100.</p>
<table>
<thead>
<tr class="header">
<th align="right">sample</th>
<th align="right">n1</th>
<th align="right">n2</th>
<th align="right">n3</th>
<th align="right">n4</th>
<th align="right">n5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">10</td>
<td align="right">0.579</td>
<td align="right">0.332</td>
<td align="right">0.224</td>
<td align="right">0.160</td>
<td align="right">0.134</td>
</tr>
<tr class="even">
<td align="right">20</td>
<td align="right">0.779</td>
<td align="right">0.475</td>
<td align="right">0.353</td>
<td align="right">0.254</td>
<td align="right">0.197</td>
</tr>
<tr class="odd">
<td align="right">30</td>
<td align="right">0.854</td>
<td align="right">0.595</td>
<td align="right">0.429</td>
<td align="right">0.318</td>
<td align="right">0.257</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">0.909</td>
<td align="right">0.681</td>
<td align="right">0.544</td>
<td align="right">0.388</td>
<td align="right">0.285</td>
</tr>
<tr class="odd">
<td align="right">100</td>
<td align="right">0.942</td>
<td align="right">0.833</td>
<td align="right">0.638</td>
<td align="right">0.497</td>
<td align="right">0.411</td>
</tr>
</tbody>
</table>
<p>For this kind of distribution, we can see from the above table that the possibility of dislocation in the first category of its norm is very high.</p>
<p>Answer 2</p>
<p>we consider the Standard normal and the results for different samples are shown in the table below.(now, the variance is the same)</p>
<table>
<thead>
<tr class="header">
<th align="left">sample</th>
<th align="right">X20</th>
<th align="right">X50</th>
<th align="right">X100</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">count 5-test</td>
<td align="right">0.065</td>
<td align="right">0.080</td>
<td align="right">0.090</td>
</tr>
<tr class="even">
<td align="left">F-test</td>
<td align="right">0.075</td>
<td align="right">0.043</td>
<td align="right">0.045</td>
</tr>
</tbody>
</table>
<p>and we consider the variance is not same.(<span class="math inline">\(\sigma_1=1\ and \ \sigma_2=1.5\)</span>)</p>
<table>
<thead>
<tr class="header">
<th align="left">sample</th>
<th align="right">X20</th>
<th align="right">X50</th>
<th align="right">X100</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">count 5-test</td>
<td align="right">0.299</td>
<td align="right">0.627</td>
<td align="right">0.846</td>
</tr>
<tr class="even">
<td align="left">F-test</td>
<td align="right">0.428</td>
<td align="right">0.801</td>
<td align="right">0.982</td>
</tr>
</tbody>
</table>
<p>In any case, the F-test is better as the sample size increased and count-5-test does the opposite. when the size is samll, we can use count-5-test, otherwise F-test is better(only normal).</p>
<p>now, we try a T-distribution(n=10).(the variance is the same)</p>
<table>
<thead>
<tr class="header">
<th align="left">sample</th>
<th align="right">X20</th>
<th align="right">X50</th>
<th align="right">X100</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">count 5-test</td>
<td align="right">0.048</td>
<td align="right">0.086</td>
<td align="right">0.093</td>
</tr>
<tr class="even">
<td align="left">F-test</td>
<td align="right">0.112</td>
<td align="right">0.129</td>
<td align="right">0.115</td>
</tr>
</tbody>
</table>
<p>it is easy to find the difference.</p>
<p>Answer 3</p>
<p>consider X and Y is Standard normal. for a bivariate normal distribution, we can obtain the covariance of its maximum likelihood method is cov(X,Y)=<span class="math inline">\(\frac1n\sum^n_{i=1}X_iY_i-\bar X\bar Y\)</span></p>
<table>
<thead>
<tr class="header">
<th align="right">sample</th>
<th align="right">power</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">10</td>
<td align="right">0.455</td>
</tr>
<tr class="even">
<td align="right">20</td>
<td align="right">0.695</td>
</tr>
<tr class="odd">
<td align="right">30</td>
<td align="right">0.822</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">0.928</td>
</tr>
<tr class="odd">
<td align="right">100</td>
<td align="right">0.975</td>
</tr>
<tr class="even">
<td align="right">500</td>
<td align="right">0.997</td>
</tr>
</tbody>
</table>
<p>I find the result is not good. when size is large, we can’t use the mothed.</p>
<p>and consider a special distribution: <span class="math inline">\((1-\epsilon)N(0,1)+\epsilon N(0,100)\)</span> <img src="data:image/png;base64,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" /><!-- --></p>
<p>Answer 4</p>
<table>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">power</th>
<th align="center">other</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">method1</td>
<td align="center">6510</td>
<td align="center">3490</td>
</tr>
<tr class="even">
<td align="center">method2</td>
<td align="center">6760</td>
<td align="center">3240</td>
</tr>
</tbody>
</table>
<p><span class="math inline">\(H_0:\)</span>two methods are different <span class="math inline">\(\Leftrightarrow\)</span> <span class="math inline">\(H_1:\)</span> two methods are same.</p>
<p>now, I use McNemar test to decide if it’s different.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>x=<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb16-2"><a href="#cb16-2"></a>x[<span class="dv">1</span>,<span class="dv">1</span>]=<span class="dv">6510</span>;x[<span class="dv">1</span>,<span class="dv">2</span>]=<span class="dv">3490</span>;</span>
<span id="cb16-3"><a href="#cb16-3"></a>x[<span class="dv">2</span>,<span class="dv">1</span>]=<span class="dv">6760</span>;x[<span class="dv">2</span>,<span class="dv">2</span>]=<span class="dv">3240</span>;</span>
<span id="cb16-4"><a href="#cb16-4"></a>X=<span class="kw">sum</span>(x)<span class="op">*</span>(x[<span class="dv">1</span>,<span class="dv">1</span>]<span class="op">*</span>x[<span class="dv">2</span>,<span class="dv">2</span>]<span class="op">-</span>x[<span class="dv">1</span>,<span class="dv">2</span>]<span class="op">*</span>x[<span class="dv">2</span>,<span class="dv">1</span>])<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="kw">sum</span>(x[<span class="dv">1</span>,])<span class="op">*</span><span class="kw">sum</span>(x[<span class="dv">2</span>,])<span class="op">*</span><span class="kw">sum</span>(x[,<span class="dv">1</span>])<span class="op">*</span><span class="kw">sum</span>(x[,<span class="dv">2</span>]))</span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="kw">print</span>(<span class="kw">c</span>(X,<span class="kw">qchisq</span>(<span class="fl">0.95</span>,<span class="dv">1</span>),<span class="kw">as.integer</span>(X<span class="op">&gt;</span><span class="kw">qchisq</span>(<span class="fl">0.95</span>,<span class="dv">1</span>))))</span></code></pre></div>
<pre><code>## [1] 13.996648  3.841459  1.000000</code></pre>
<p>so, we reject the <span class="math inline">\(H_0\)</span>, we can’t think they are different.</p>
</div>
<div id="question-4" class="section level2">
<h2>Question</h2>
<p>1(7.1).Compute a jackknife estimate of the bias and the standard error of the correlation statistic in Example 7.2.</p>
<p>2(7.5).Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for the mean time between failures <span class="math inline">\(1/\lambda\)</span> by the standard normal, basic, percentile, and BCa methods. Compare the intervals and explain why they may differ.</p>
<p>3(7.8).Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat\theta\)</span>.</p>
<p>4(7.11). In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Use leave-two-out cross validation to compare the models.</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<p>Answer 1</p>
<p>By using jackknife method to estimate the bias and the standard error of the correlation statistic in Example 7.2.</p>
<p>Then the first answer is the bias and the other one is the standard error.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw">library</span>(bootstrap)</span>
<span id="cb18-2"><a href="#cb18-2"></a>n=<span class="kw">length</span>(law<span class="op">$</span>LSAT)</span>
<span id="cb18-3"><a href="#cb18-3"></a>x=<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span><span class="dv">2</span>,<span class="dt">ncol=</span>n)</span>
<span id="cb18-4"><a href="#cb18-4"></a>x[<span class="dv">1</span>,]=law<span class="op">$</span>LSAT;x[<span class="dv">2</span>,]=law<span class="op">$</span>GPA;</span>
<span id="cb18-5"><a href="#cb18-5"></a>theta.hat=<span class="kw">cor</span>(law<span class="op">$</span>LSAT,law<span class="op">$</span>GPA)</span>
<span id="cb18-6"><a href="#cb18-6"></a>theta.jack=<span class="kw">numeric</span>(n)</span>
<span id="cb18-7"><a href="#cb18-7"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb18-8"><a href="#cb18-8"></a>  theta.jack[i]=<span class="kw">cor</span>(x[<span class="dv">1</span>,(<span class="dv">1</span><span class="op">:</span>n)[<span class="op">-</span>i]],x[<span class="dv">2</span>,(<span class="dv">1</span><span class="op">:</span>n)[<span class="op">-</span>i]])</span>
<span id="cb18-9"><a href="#cb18-9"></a>}</span>
<span id="cb18-10"><a href="#cb18-10"></a>bias.jack=(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.jack)<span class="op">-</span>theta.hat)</span>
<span id="cb18-11"><a href="#cb18-11"></a>se.jack=(n<span class="dv">-1</span>)<span class="op">/</span><span class="kw">sqrt</span>(n)<span class="op">*</span><span class="kw">sd</span>(theta.jack)</span>
<span id="cb18-12"><a href="#cb18-12"></a></span>
<span id="cb18-13"><a href="#cb18-13"></a><span class="kw">print</span>(<span class="kw">c</span>(bias.jack,se.jack))</span></code></pre></div>
<pre><code>## [1] -0.006473623  0.142518619</code></pre>
<p>Answer 2</p>
<p>The standard bootstrap CI based on standard normal:</p>
<pre><code>## [1]  34.96825 181.19842</code></pre>
<p>The standard bootstrap CI based on basic:</p>
<pre><code>## [1]  25.24792 262.91667</code></pre>
<p>The standard bootstrap CI based on percentile:</p>
<pre><code>## [1]  46.7500 190.9187</code></pre>
<p>The standard bootstrap CI based on BCa:</p>
<pre><code>## [1]  57 225</code></pre>
<p>Because they have different methods to estimate it. We use different asymptotic properties to complete the confidence interval estimation. As the sample size n increases, the differences between them gradually decrease. But the n=12, so they have a big different.</p>
<p>Answer 3</p>
<p>The first answer is bias and the other one is standard error.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="kw">library</span>(bootstrap)</span>
<span id="cb24-2"><a href="#cb24-2"></a>score=scor</span>
<span id="cb24-3"><a href="#cb24-3"></a>n=<span class="kw">length</span>(score[,<span class="dv">1</span>])</span>
<span id="cb24-4"><a href="#cb24-4"></a>covmatrix1=covmatrix=<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span><span class="dv">5</span>,<span class="dt">ncol=</span><span class="dv">5</span>)</span>
<span id="cb24-5"><a href="#cb24-5"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb24-6"><a href="#cb24-6"></a>  <span class="cf">for</span>(j <span class="cf">in</span> i<span class="op">:</span><span class="dv">5</span>) covmatrix[i,j]=covmatrix[j,i]=<span class="kw">cov</span>(score[,i],score[,j])</span>
<span id="cb24-7"><a href="#cb24-7"></a>lambdavalues=<span class="kw">eigen</span>(covmatrix)<span class="op">$</span>values</span>
<span id="cb24-8"><a href="#cb24-8"></a>theta.hat=<span class="kw">max</span>(lambdavalues)<span class="op">/</span><span class="kw">sum</span>(lambdavalues)</span>
<span id="cb24-9"><a href="#cb24-9"></a>theta.star=<span class="kw">numeric</span>(n)</span>
<span id="cb24-10"><a href="#cb24-10"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb24-11"><a href="#cb24-11"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb24-12"><a href="#cb24-12"></a>    <span class="cf">for</span>(j <span class="cf">in</span> i<span class="op">:</span><span class="dv">5</span>) covmatrix1[i,j]=covmatrix[j,i]=<span class="kw">cov</span>(score[<span class="op">-</span>k,i],score[<span class="op">-</span>k,j])</span>
<span id="cb24-13"><a href="#cb24-13"></a>    theta.star[k]=<span class="kw">max</span>(<span class="kw">eigen</span>(covmatrix)<span class="op">$</span>values)<span class="op">/</span><span class="kw">sum</span>(<span class="kw">eigen</span>(covmatrix)<span class="op">$</span>values)</span>
<span id="cb24-14"><a href="#cb24-14"></a>}</span>
<span id="cb24-15"><a href="#cb24-15"></a>bias.jack=(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.star)<span class="op">-</span>theta.hat)</span>
<span id="cb24-16"><a href="#cb24-16"></a>se.jack=(n<span class="dv">-1</span>)<span class="op">/</span><span class="kw">sqrt</span>(n)<span class="op">*</span><span class="kw">sd</span>(theta.star)</span>
<span id="cb24-17"><a href="#cb24-17"></a><span class="kw">print</span>(<span class="kw">c</span>(bias.jack,se.jack))</span></code></pre></div>
<pre><code>## [1] 8.107791e-05 1.966510e-02</code></pre>
<p>Answer 4</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="kw">library</span>(DAAG);</span></code></pre></div>
<pre><code>## 载入需要的程辑包：lattice</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>magnetic=ironslag<span class="op">$</span>magnetic</span>
<span id="cb28-2"><a href="#cb28-2"></a>chemical=ironslag<span class="op">$</span>chemical</span>
<span id="cb28-3"><a href="#cb28-3"></a>n=<span class="kw">length</span>(magnetic)</span>
<span id="cb28-4"><a href="#cb28-4"></a>e1=e2=e3=e4=<span class="kw">numeric</span>(n<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb28-5"><a href="#cb28-5"></a>k=<span class="dv">1</span></span>
<span id="cb28-6"><a href="#cb28-6"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n)</span>
<span id="cb28-7"><a href="#cb28-7"></a>  <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n){</span>
<span id="cb28-8"><a href="#cb28-8"></a>    <span class="cf">if</span>(i<span class="op">==</span>n) <span class="cf">break</span></span>
<span id="cb28-9"><a href="#cb28-9"></a>    y=magnetic[<span class="kw">c</span>(<span class="op">-</span>i,<span class="op">-</span>j)]</span>
<span id="cb28-10"><a href="#cb28-10"></a>    x=chemical[<span class="kw">c</span>(<span class="op">-</span>i,<span class="op">-</span>j)]</span>
<span id="cb28-11"><a href="#cb28-11"></a>    </span>
<span id="cb28-12"><a href="#cb28-12"></a>    L1=<span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb28-13"><a href="#cb28-13"></a>    yhat1=L1<span class="op">$</span>coef[<span class="dv">1</span>]<span class="op">+</span>L1<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span>chemical[<span class="kw">c</span>(i,j)]</span>
<span id="cb28-14"><a href="#cb28-14"></a>    e1[k]=<span class="kw">sum</span>((magnetic[<span class="kw">c</span>(i,j)]<span class="op">-</span>yhat1)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb28-15"><a href="#cb28-15"></a>    </span>
<span id="cb28-16"><a href="#cb28-16"></a>    L2=<span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x<span class="op">+</span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb28-17"><a href="#cb28-17"></a>    yhat2=L2<span class="op">$</span>coef[<span class="dv">1</span>]<span class="op">+</span>L2<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span>chemical[<span class="kw">c</span>(i,j)]<span class="op">+</span>L2<span class="op">$</span>coef[<span class="dv">3</span>]<span class="op">*</span>chemical[<span class="kw">c</span>(i,j)]<span class="op">^</span><span class="dv">2</span></span>
<span id="cb28-18"><a href="#cb28-18"></a>    e2[k]=<span class="kw">sum</span>((magnetic[<span class="kw">c</span>(i,j)]<span class="op">-</span>yhat2)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb28-19"><a href="#cb28-19"></a>    </span>
<span id="cb28-20"><a href="#cb28-20"></a>    L3=<span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb28-21"><a href="#cb28-21"></a>    yhat3=L3<span class="op">$</span>coef[<span class="dv">1</span>]<span class="op">+</span>L3<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span>chemical[<span class="kw">c</span>(i,j)]</span>
<span id="cb28-22"><a href="#cb28-22"></a>    e3[k]=<span class="kw">sum</span>((magnetic[<span class="kw">c</span>(i,j)]<span class="op">-</span><span class="kw">exp</span>(yhat3))<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb28-23"><a href="#cb28-23"></a>    </span>
<span id="cb28-24"><a href="#cb28-24"></a>    L4=<span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(x))</span>
<span id="cb28-25"><a href="#cb28-25"></a>    yhat4=L4<span class="op">$</span>coef[<span class="dv">1</span>]<span class="op">+</span>L4<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span><span class="kw">log</span>(chemical[<span class="kw">c</span>(i,j)])</span>
<span id="cb28-26"><a href="#cb28-26"></a>    e4[k]=<span class="kw">sum</span>((magnetic[<span class="kw">c</span>(i,j)]<span class="op">-</span><span class="kw">exp</span>(yhat4))<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb28-27"><a href="#cb28-27"></a>    k=k<span class="op">+</span><span class="dv">1</span></span>
<span id="cb28-28"><a href="#cb28-28"></a>  }</span>
<span id="cb28-29"><a href="#cb28-29"></a><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(e1),<span class="kw">mean</span>(e2),<span class="kw">mean</span>(e3),<span class="kw">mean</span>(e4)))</span></code></pre></div>
<pre><code>## [1] 39.14455 35.74037 36.90983 40.93436</code></pre>
<p>According to the prediction error criterion, Model 2, the quadratic model, would be the best fit for the data.</p>
</div>
<div id="question-5" class="section level2">
<h2>Question</h2>
<p>1(8.3).The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
<p>2.Design experiments for evaluating the performance of the NN,energy, and ball methods in various situations. (1).Unequal variances and equal expectations (2).Unequal variances and unequal expectations (3).Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions) (4).Unbalanced samples (say, 1 case versus 10 controls) (5).Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8)</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<p>Answer 1</p>
<p>Now, I will limit the maximum number of extreme points based on the quantile at 0.95. According to the number of known samples, the corresponding number value of 0.95 bits is obtained, and after taking the whole and minus one is taken as my new judgment condition.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>maxout &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb30-2"><a href="#cb30-2"></a>  X=x<span class="op">-</span><span class="kw">mean</span>(x)</span>
<span id="cb30-3"><a href="#cb30-3"></a>  Y=y<span class="op">-</span><span class="kw">mean</span>(y)</span>
<span id="cb30-4"><a href="#cb30-4"></a>  outx=<span class="kw">sum</span>(X<span class="op">&gt;</span><span class="kw">max</span>(Y))<span class="op">+</span><span class="kw">sum</span>(X<span class="op">&lt;</span><span class="kw">min</span>(Y))</span>
<span id="cb30-5"><a href="#cb30-5"></a>  outy=<span class="kw">sum</span>(Y<span class="op">&gt;</span><span class="kw">max</span>(X))<span class="op">+</span><span class="kw">sum</span>(Y<span class="op">&lt;</span><span class="kw">min</span>(X))</span>
<span id="cb30-6"><a href="#cb30-6"></a>  <span class="kw">return</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)))</span>
<span id="cb30-7"><a href="#cb30-7"></a>}</span>
<span id="cb30-8"><a href="#cb30-8"></a>count5test=<span class="cf">function</span>(x,y,num){</span>
<span id="cb30-9"><a href="#cb30-9"></a>  X=x<span class="op">-</span><span class="kw">mean</span>(x)</span>
<span id="cb30-10"><a href="#cb30-10"></a>  Y=y<span class="op">-</span><span class="kw">mean</span>(y)</span>
<span id="cb30-11"><a href="#cb30-11"></a>  outx=<span class="kw">sum</span>(X<span class="op">&gt;</span><span class="kw">max</span>(Y))<span class="op">+</span><span class="kw">sum</span>(x<span class="op">&lt;</span><span class="kw">min</span>(Y))</span>
<span id="cb30-12"><a href="#cb30-12"></a>  outy=<span class="kw">sum</span>(Y<span class="op">&gt;</span><span class="kw">max</span>(X))<span class="op">+</span><span class="kw">sum</span>(Y<span class="op">&lt;</span><span class="kw">min</span>(X))</span>
<span id="cb30-13"><a href="#cb30-13"></a>  <span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb30-14"><a href="#cb30-14"></a>  <span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy))<span class="op">&gt;</span>num))</span>
<span id="cb30-15"><a href="#cb30-15"></a>}</span>
<span id="cb30-16"><a href="#cb30-16"></a>n1=<span class="dv">30</span></span>
<span id="cb30-17"><a href="#cb30-17"></a>n2=<span class="dv">50</span></span>
<span id="cb30-18"><a href="#cb30-18"></a>m=<span class="dv">1000</span></span>
<span id="cb30-19"><a href="#cb30-19"></a><span class="kw">set.seed</span>(<span class="dv">980904</span>)</span>
<span id="cb30-20"><a href="#cb30-20"></a>stat &lt;-<span class="st"> </span><span class="kw">replicate</span>(m,<span class="dt">expr=</span>{</span>
<span id="cb30-21"><a href="#cb30-21"></a>x=<span class="kw">rnorm</span>(n1)</span>
<span id="cb30-22"><a href="#cb30-22"></a>y=<span class="kw">rnorm</span>(n2)</span>
<span id="cb30-23"><a href="#cb30-23"></a><span class="kw">maxout</span>(x, y)</span>
<span id="cb30-24"><a href="#cb30-24"></a>})</span>
<span id="cb30-25"><a href="#cb30-25"></a>num=<span class="kw">as.integer</span>(<span class="kw">quantile</span>(stat, <span class="kw">c</span>(.<span class="dv">95</span>)))<span class="op">-</span><span class="dv">1</span></span>
<span id="cb30-26"><a href="#cb30-26"></a>B=<span class="dv">1000</span></span>
<span id="cb30-27"><a href="#cb30-27"></a>test=<span class="kw">numeric</span>(B)</span>
<span id="cb30-28"><a href="#cb30-28"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B){</span>
<span id="cb30-29"><a href="#cb30-29"></a>  x=<span class="kw">rnorm</span>(n1);y=<span class="kw">rnorm</span>(n2)</span>
<span id="cb30-30"><a href="#cb30-30"></a>  test[i]=<span class="kw">count5test</span>(x,y,num)</span>
<span id="cb30-31"><a href="#cb30-31"></a>}</span>
<span id="cb30-32"><a href="#cb30-32"></a><span class="kw">print</span>(<span class="kw">mean</span>(test))</span></code></pre></div>
<pre><code>## [1] 0.061</code></pre>
<p>We can find it is liberal. but the deviation is not big.</p>
<p>Answer 2</p>
<p>question(1): we consider a normal distribution with a mean of 0 and a variance of 1 and 1.5.</p>
<p>(The first one is the p value of NN, the second one is the p value of energy, the third one is the p value of Ball, the same below)</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="kw">library</span>(boot)</span></code></pre></div>
<pre><code>## 
## 载入程辑包：&#39;boot&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:lattice&#39;:
## 
##     melanoma</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="kw">library</span>(RANN)</span>
<span id="cb35-2"><a href="#cb35-2"></a><span class="kw">library</span>(energy)</span>
<span id="cb35-3"><a href="#cb35-3"></a><span class="kw">library</span>(Ball)</span>
<span id="cb35-4"><a href="#cb35-4"></a>Tn=<span class="cf">function</span>(z, ix, sizes,k){</span>
<span id="cb35-5"><a href="#cb35-5"></a>n1=sizes[<span class="dv">1</span>];n2=sizes[<span class="dv">2</span>];n=n1<span class="op">+</span>n2</span>
<span id="cb35-6"><a href="#cb35-6"></a><span class="cf">if</span>(<span class="kw">is.vector</span>(z))z=<span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb35-7"><a href="#cb35-7"></a>z=z[ix, ];</span>
<span id="cb35-8"><a href="#cb35-8"></a>NN=<span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb35-9"><a href="#cb35-9"></a>block1=NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb35-10"><a href="#cb35-10"></a>block2=NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb35-11"><a href="#cb35-11"></a>i1=<span class="kw">sum</span>(block1<span class="op">&lt;</span>n1<span class="fl">+.5</span>);i2=<span class="kw">sum</span>(block2<span class="op">&gt;</span>n1<span class="fl">+.5</span>)</span>
<span id="cb35-12"><a href="#cb35-12"></a><span class="kw">return</span>((i1<span class="op">+</span>i2)<span class="op">/</span>(k<span class="op">*</span>n))</span>
<span id="cb35-13"><a href="#cb35-13"></a>}</span>
<span id="cb35-14"><a href="#cb35-14"></a></span>
<span id="cb35-15"><a href="#cb35-15"></a>n=<span class="dv">20</span></span>
<span id="cb35-16"><a href="#cb35-16"></a><span class="kw">set.seed</span>(<span class="dv">980904</span>)</span>
<span id="cb35-17"><a href="#cb35-17"></a>x=<span class="kw">matrix</span>(<span class="kw">rnorm</span>(n<span class="op">*</span><span class="dv">2</span>),<span class="dt">nrow=</span>n,<span class="dt">ncol=</span><span class="dv">2</span>)</span>
<span id="cb35-18"><a href="#cb35-18"></a>y=<span class="kw">matrix</span>(<span class="kw">rnorm</span>(n<span class="op">*</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="fl">1.5</span>),<span class="dt">nrow=</span>n,<span class="dt">ncol=</span><span class="dv">2</span>)</span>
<span id="cb35-19"><a href="#cb35-19"></a>z=<span class="kw">rbind</span>(x,y)</span>
<span id="cb35-20"><a href="#cb35-20"></a>p.value=<span class="kw">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb35-21"><a href="#cb35-21"></a>N=<span class="kw">c</span>(<span class="kw">nrow</span>(x),<span class="kw">nrow</span>(y))</span>
<span id="cb35-22"><a href="#cb35-22"></a></span>
<span id="cb35-23"><a href="#cb35-23"></a>boot.obj=<span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">sim=</span><span class="st">&quot;permutation&quot;</span>,<span class="dt">sizes=</span>N,<span class="dt">k=</span><span class="dv">3</span>)</span>
<span id="cb35-24"><a href="#cb35-24"></a>ts=<span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb35-25"><a href="#cb35-25"></a>p.value[<span class="dv">1</span>]=<span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb35-26"><a href="#cb35-26"></a></span>
<span id="cb35-27"><a href="#cb35-27"></a>boot.obs=<span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span><span class="dv">999</span>)</span>
<span id="cb35-28"><a href="#cb35-28"></a>p.value[<span class="dv">2</span>]=boot.obs<span class="op">$</span>p.value</span>
<span id="cb35-29"><a href="#cb35-29"></a></span>
<span id="cb35-30"><a href="#cb35-30"></a>p.value[<span class="dv">3</span>]=<span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>)<span class="op">$</span>p.value</span>
<span id="cb35-31"><a href="#cb35-31"></a></span>
<span id="cb35-32"><a href="#cb35-32"></a><span class="kw">print</span>(p.value)</span></code></pre></div>
<pre><code>## [1] 0.189 0.106 0.160</code></pre>
<p>question(2): we consider a normal distribution with a mean of 0 and 1 and a variance of 1.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="kw">library</span>(boot)</span>
<span id="cb37-2"><a href="#cb37-2"></a><span class="kw">library</span>(RANN)</span>
<span id="cb37-3"><a href="#cb37-3"></a><span class="kw">library</span>(energy)</span>
<span id="cb37-4"><a href="#cb37-4"></a><span class="kw">library</span>(Ball)</span>
<span id="cb37-5"><a href="#cb37-5"></a>Tn=<span class="cf">function</span>(z, ix, sizes,k){</span>
<span id="cb37-6"><a href="#cb37-6"></a>n1=sizes[<span class="dv">1</span>];n2=sizes[<span class="dv">2</span>];n=n1<span class="op">+</span>n2</span>
<span id="cb37-7"><a href="#cb37-7"></a><span class="cf">if</span>(<span class="kw">is.vector</span>(z))z=<span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb37-8"><a href="#cb37-8"></a>z=z[ix, ];</span>
<span id="cb37-9"><a href="#cb37-9"></a>NN=<span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb37-10"><a href="#cb37-10"></a>block1=NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb37-11"><a href="#cb37-11"></a>block2=NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb37-12"><a href="#cb37-12"></a>i1=<span class="kw">sum</span>(block1<span class="op">&lt;</span>n1<span class="fl">+.5</span>);i2=<span class="kw">sum</span>(block2<span class="op">&gt;</span>n1<span class="fl">+.5</span>)</span>
<span id="cb37-13"><a href="#cb37-13"></a><span class="kw">return</span>((i1<span class="op">+</span>i2)<span class="op">/</span>(k<span class="op">*</span>n))</span>
<span id="cb37-14"><a href="#cb37-14"></a>}</span>
<span id="cb37-15"><a href="#cb37-15"></a></span>
<span id="cb37-16"><a href="#cb37-16"></a>n=<span class="dv">20</span></span>
<span id="cb37-17"><a href="#cb37-17"></a><span class="kw">set.seed</span>(<span class="dv">980904</span>)</span>
<span id="cb37-18"><a href="#cb37-18"></a>x=<span class="kw">matrix</span>(<span class="kw">rnorm</span>(n<span class="op">*</span><span class="dv">2</span>),<span class="dt">nrow=</span>n,<span class="dt">ncol=</span><span class="dv">2</span>)</span>
<span id="cb37-19"><a href="#cb37-19"></a>y=<span class="kw">matrix</span>(<span class="kw">rnorm</span>(n<span class="op">*</span><span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="dt">nrow=</span>n,<span class="dt">ncol=</span><span class="dv">2</span>)</span>
<span id="cb37-20"><a href="#cb37-20"></a>z=<span class="kw">rbind</span>(x,y)</span>
<span id="cb37-21"><a href="#cb37-21"></a>p.value=<span class="kw">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb37-22"><a href="#cb37-22"></a>N=<span class="kw">c</span>(<span class="kw">nrow</span>(x),<span class="kw">nrow</span>(y))</span>
<span id="cb37-23"><a href="#cb37-23"></a></span>
<span id="cb37-24"><a href="#cb37-24"></a>boot.obj=<span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">sim=</span><span class="st">&quot;permutation&quot;</span>,<span class="dt">sizes=</span>N,<span class="dt">k=</span><span class="dv">3</span>)</span>
<span id="cb37-25"><a href="#cb37-25"></a>ts=<span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb37-26"><a href="#cb37-26"></a>p.value[<span class="dv">1</span>]=<span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb37-27"><a href="#cb37-27"></a></span>
<span id="cb37-28"><a href="#cb37-28"></a>boot.obs=<span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span><span class="dv">999</span>)</span>
<span id="cb37-29"><a href="#cb37-29"></a>p.value[<span class="dv">2</span>]=boot.obs<span class="op">$</span>p.value</span>
<span id="cb37-30"><a href="#cb37-30"></a></span>
<span id="cb37-31"><a href="#cb37-31"></a>p.value[<span class="dv">3</span>]=<span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>)<span class="op">$</span>p.value</span>
<span id="cb37-32"><a href="#cb37-32"></a></span>
<span id="cb37-33"><a href="#cb37-33"></a><span class="kw">print</span>(p.value)</span></code></pre></div>
<pre><code>## [1] 0.748 0.300 0.430</code></pre>
<p>question(3): we consider a t distribution with df=1.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="kw">library</span>(boot)</span>
<span id="cb39-2"><a href="#cb39-2"></a><span class="kw">library</span>(RANN)</span>
<span id="cb39-3"><a href="#cb39-3"></a><span class="kw">library</span>(energy)</span>
<span id="cb39-4"><a href="#cb39-4"></a><span class="kw">library</span>(Ball)</span>
<span id="cb39-5"><a href="#cb39-5"></a>Tn=<span class="cf">function</span>(z, ix, sizes,k){</span>
<span id="cb39-6"><a href="#cb39-6"></a>n1=sizes[<span class="dv">1</span>];n2=sizes[<span class="dv">2</span>];n=n1<span class="op">+</span>n2</span>
<span id="cb39-7"><a href="#cb39-7"></a><span class="cf">if</span>(<span class="kw">is.vector</span>(z))z=<span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb39-8"><a href="#cb39-8"></a>z=z[ix, ];</span>
<span id="cb39-9"><a href="#cb39-9"></a>NN=<span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb39-10"><a href="#cb39-10"></a>block1=NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb39-11"><a href="#cb39-11"></a>block2=NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb39-12"><a href="#cb39-12"></a>i1=<span class="kw">sum</span>(block1<span class="op">&lt;</span>n1<span class="fl">+.5</span>);i2=<span class="kw">sum</span>(block2<span class="op">&gt;</span>n1<span class="fl">+.5</span>)</span>
<span id="cb39-13"><a href="#cb39-13"></a><span class="kw">return</span>((i1<span class="op">+</span>i2)<span class="op">/</span>(k<span class="op">*</span>n))</span>
<span id="cb39-14"><a href="#cb39-14"></a>}</span>
<span id="cb39-15"><a href="#cb39-15"></a></span>
<span id="cb39-16"><a href="#cb39-16"></a>n=<span class="dv">20</span></span>
<span id="cb39-17"><a href="#cb39-17"></a><span class="kw">set.seed</span>(<span class="dv">980904</span>)</span>
<span id="cb39-18"><a href="#cb39-18"></a>x=<span class="kw">matrix</span>(<span class="kw">rt</span>(n<span class="op">*</span><span class="dv">1</span>,<span class="dv">1</span>),<span class="dt">nrow=</span>n,<span class="dt">ncol=</span><span class="dv">1</span>)</span>
<span id="cb39-19"><a href="#cb39-19"></a>y=<span class="kw">matrix</span>(<span class="kw">rt</span>(n<span class="op">*</span><span class="dv">1</span>,<span class="dv">1</span>),<span class="dt">nrow=</span>n,<span class="dt">ncol=</span><span class="dv">1</span>)</span>
<span id="cb39-20"><a href="#cb39-20"></a>z=<span class="kw">rbind</span>(x,y)</span>
<span id="cb39-21"><a href="#cb39-21"></a>p.value=<span class="kw">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb39-22"><a href="#cb39-22"></a>N=<span class="kw">c</span>(<span class="kw">nrow</span>(x),<span class="kw">nrow</span>(y))</span>
<span id="cb39-23"><a href="#cb39-23"></a></span>
<span id="cb39-24"><a href="#cb39-24"></a>boot.obj=<span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">sim=</span><span class="st">&quot;permutation&quot;</span>,<span class="dt">sizes=</span>N,<span class="dt">k=</span><span class="dv">3</span>)</span>
<span id="cb39-25"><a href="#cb39-25"></a>ts=<span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb39-26"><a href="#cb39-26"></a>p.value[<span class="dv">1</span>]=<span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb39-27"><a href="#cb39-27"></a></span>
<span id="cb39-28"><a href="#cb39-28"></a>boot.obs=<span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span><span class="dv">999</span>)</span>
<span id="cb39-29"><a href="#cb39-29"></a>p.value[<span class="dv">2</span>]=boot.obs<span class="op">$</span>p.value</span>
<span id="cb39-30"><a href="#cb39-30"></a></span>
<span id="cb39-31"><a href="#cb39-31"></a>p.value[<span class="dv">3</span>]=<span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>)<span class="op">$</span>p.value</span>
<span id="cb39-32"><a href="#cb39-32"></a></span>
<span id="cb39-33"><a href="#cb39-33"></a><span class="kw">print</span>(p.value)</span></code></pre></div>
<pre><code>## [1] 0.509 0.465 0.670</code></pre>
<p>we consider the <span class="math inline">\(\alpha N(0,1)+(1-\alpha)N(0,100)\)</span> with <span class="math inline">\(\alpha=0\ or\ 1\)</span>.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="kw">library</span>(boot)</span>
<span id="cb41-2"><a href="#cb41-2"></a><span class="kw">library</span>(RANN)</span>
<span id="cb41-3"><a href="#cb41-3"></a><span class="kw">library</span>(energy)</span>
<span id="cb41-4"><a href="#cb41-4"></a><span class="kw">library</span>(Ball)</span>
<span id="cb41-5"><a href="#cb41-5"></a>Tn=<span class="cf">function</span>(z, ix, sizes,k){</span>
<span id="cb41-6"><a href="#cb41-6"></a>n1=sizes[<span class="dv">1</span>];n2=sizes[<span class="dv">2</span>];n=n1<span class="op">+</span>n2</span>
<span id="cb41-7"><a href="#cb41-7"></a><span class="cf">if</span>(<span class="kw">is.vector</span>(z))z=<span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb41-8"><a href="#cb41-8"></a>z=z[ix, ];</span>
<span id="cb41-9"><a href="#cb41-9"></a>NN=<span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb41-10"><a href="#cb41-10"></a>block1=NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb41-11"><a href="#cb41-11"></a>block2=NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb41-12"><a href="#cb41-12"></a>i1=<span class="kw">sum</span>(block1<span class="op">&lt;</span>n1<span class="fl">+.5</span>);i2=<span class="kw">sum</span>(block2<span class="op">&gt;</span>n1<span class="fl">+.5</span>)</span>
<span id="cb41-13"><a href="#cb41-13"></a><span class="kw">return</span>((i1<span class="op">+</span>i2)<span class="op">/</span>(k<span class="op">*</span>n))</span>
<span id="cb41-14"><a href="#cb41-14"></a>}</span>
<span id="cb41-15"><a href="#cb41-15"></a></span>
<span id="cb41-16"><a href="#cb41-16"></a>n=<span class="dv">20</span></span>
<span id="cb41-17"><a href="#cb41-17"></a><span class="kw">set.seed</span>(<span class="dv">980904</span>)</span>
<span id="cb41-18"><a href="#cb41-18"></a>complex=<span class="kw">matrix</span>(<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">size=</span><span class="dv">2</span><span class="op">*</span><span class="dv">2</span><span class="op">*</span>n,<span class="dt">replace=</span><span class="ot">TRUE</span>),<span class="dt">nrow=</span><span class="dv">2</span>,<span class="dt">ncol=</span><span class="dv">2</span><span class="op">*</span>n)</span>
<span id="cb41-19"><a href="#cb41-19"></a>x=<span class="kw">matrix</span>(<span class="kw">rnorm</span>(n<span class="op">*</span><span class="dv">2</span>,<span class="dv">0</span>,complex[<span class="dv">1</span>,]<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>complex[<span class="dv">1</span>,])<span class="op">*</span><span class="dv">100</span>),<span class="dt">nrow=</span>n,<span class="dt">ncol=</span><span class="dv">2</span>)</span>
<span id="cb41-20"><a href="#cb41-20"></a>y=<span class="kw">matrix</span>(<span class="kw">rnorm</span>(n<span class="op">*</span><span class="dv">2</span>,<span class="dv">0</span>,complex[<span class="dv">2</span>,]<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>complex[<span class="dv">2</span>,])<span class="op">*</span><span class="dv">100</span>),<span class="dt">nrow=</span>n,<span class="dt">ncol=</span><span class="dv">2</span>)</span>
<span id="cb41-21"><a href="#cb41-21"></a>z=<span class="kw">rbind</span>(x,y)</span>
<span id="cb41-22"><a href="#cb41-22"></a>p.value=<span class="kw">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb41-23"><a href="#cb41-23"></a>N=<span class="kw">c</span>(<span class="kw">nrow</span>(x),<span class="kw">nrow</span>(y))</span>
<span id="cb41-24"><a href="#cb41-24"></a></span>
<span id="cb41-25"><a href="#cb41-25"></a>boot.obj=<span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">sim=</span><span class="st">&quot;permutation&quot;</span>,<span class="dt">sizes=</span>N,<span class="dt">k=</span><span class="dv">3</span>)</span>
<span id="cb41-26"><a href="#cb41-26"></a>ts=<span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb41-27"><a href="#cb41-27"></a>p.value[<span class="dv">1</span>]=<span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb41-28"><a href="#cb41-28"></a></span>
<span id="cb41-29"><a href="#cb41-29"></a>boot.obs=<span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span><span class="dv">999</span>)</span>
<span id="cb41-30"><a href="#cb41-30"></a>p.value[<span class="dv">2</span>]=boot.obs<span class="op">$</span>p.value</span>
<span id="cb41-31"><a href="#cb41-31"></a></span>
<span id="cb41-32"><a href="#cb41-32"></a>p.value[<span class="dv">3</span>]=<span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>)<span class="op">$</span>p.value</span>
<span id="cb41-33"><a href="#cb41-33"></a></span>
<span id="cb41-34"><a href="#cb41-34"></a><span class="kw">print</span>(p.value)</span></code></pre></div>
<pre><code>## [1] 0.753 0.858 0.890</code></pre>
<p>question(4): we consider a normal distribution with a mean of 0 and a variance of 1, and the sample size of x is 20 and the sample size of y is 40.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="kw">library</span>(boot)</span>
<span id="cb43-2"><a href="#cb43-2"></a><span class="kw">library</span>(RANN)</span>
<span id="cb43-3"><a href="#cb43-3"></a><span class="kw">library</span>(energy)</span>
<span id="cb43-4"><a href="#cb43-4"></a><span class="kw">library</span>(Ball)</span>
<span id="cb43-5"><a href="#cb43-5"></a>Tn=<span class="cf">function</span>(z, ix, sizes,k){</span>
<span id="cb43-6"><a href="#cb43-6"></a>n1=sizes[<span class="dv">1</span>];n2=sizes[<span class="dv">2</span>];n=n1<span class="op">+</span>n2</span>
<span id="cb43-7"><a href="#cb43-7"></a><span class="cf">if</span>(<span class="kw">is.vector</span>(z))z=<span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb43-8"><a href="#cb43-8"></a>z=z[ix, ];</span>
<span id="cb43-9"><a href="#cb43-9"></a>NN=<span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb43-10"><a href="#cb43-10"></a>block1=NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb43-11"><a href="#cb43-11"></a>block2=NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb43-12"><a href="#cb43-12"></a>i1=<span class="kw">sum</span>(block1<span class="op">&lt;</span>n1<span class="fl">+.5</span>);i2=<span class="kw">sum</span>(block2<span class="op">&gt;</span>n1<span class="fl">+.5</span>)</span>
<span id="cb43-13"><a href="#cb43-13"></a><span class="kw">return</span>((i1<span class="op">+</span>i2)<span class="op">/</span>(k<span class="op">*</span>n))</span>
<span id="cb43-14"><a href="#cb43-14"></a>}</span>
<span id="cb43-15"><a href="#cb43-15"></a></span>
<span id="cb43-16"><a href="#cb43-16"></a>n1=<span class="dv">20</span></span>
<span id="cb43-17"><a href="#cb43-17"></a>n2=<span class="dv">40</span></span>
<span id="cb43-18"><a href="#cb43-18"></a><span class="kw">set.seed</span>(<span class="dv">980904</span>)</span>
<span id="cb43-19"><a href="#cb43-19"></a>x=<span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span><span class="dv">2</span>),<span class="dt">nrow=</span>n1,<span class="dt">ncol=</span><span class="dv">2</span>)</span>
<span id="cb43-20"><a href="#cb43-20"></a>y=<span class="kw">matrix</span>(<span class="kw">rnorm</span>(n2<span class="op">*</span><span class="dv">2</span>),<span class="dt">nrow=</span>n2,<span class="dt">ncol=</span><span class="dv">2</span>)</span>
<span id="cb43-21"><a href="#cb43-21"></a>z=<span class="kw">rbind</span>(x,y)</span>
<span id="cb43-22"><a href="#cb43-22"></a>p.value=<span class="kw">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb43-23"><a href="#cb43-23"></a>N=<span class="kw">c</span>(<span class="kw">nrow</span>(x),<span class="kw">nrow</span>(y))</span>
<span id="cb43-24"><a href="#cb43-24"></a></span>
<span id="cb43-25"><a href="#cb43-25"></a>boot.obj=<span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">sim=</span><span class="st">&quot;permutation&quot;</span>,<span class="dt">sizes=</span>N,<span class="dt">k=</span><span class="dv">3</span>)</span>
<span id="cb43-26"><a href="#cb43-26"></a>ts=<span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb43-27"><a href="#cb43-27"></a>p.value[<span class="dv">1</span>]=<span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb43-28"><a href="#cb43-28"></a></span>
<span id="cb43-29"><a href="#cb43-29"></a>boot.obs=<span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span><span class="dv">999</span>)</span>
<span id="cb43-30"><a href="#cb43-30"></a>p.value[<span class="dv">2</span>]=boot.obs<span class="op">$</span>p.value</span>
<span id="cb43-31"><a href="#cb43-31"></a></span>
<span id="cb43-32"><a href="#cb43-32"></a>p.value[<span class="dv">3</span>]=<span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>)<span class="op">$</span>p.value</span>
<span id="cb43-33"><a href="#cb43-33"></a></span>
<span id="cb43-34"><a href="#cb43-34"></a><span class="kw">print</span>(p.value)</span></code></pre></div>
<pre><code>## [1] 0.165 0.126 0.320</code></pre>
</div>
<div id="question-6" class="section level2">
<h2>Question</h2>
<p>1(9.4).Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p>
<p>2.For Exercise 9.4, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat R &lt; 1.2\)</span>.</p>
<p>3(11.4).Find the intersection points A(k) in <span class="math inline">\((0.\sqrt k)\)</span> of the curves <span class="math display">\[\begin{align*}
S_{k-1}(a)=P(t(k-1)&gt;\sqrt {\frac{a^2(k-1)}{k-a^2}})
\end{align*}\]</span> and <span class="math display">\[\begin{align*}
S_{k}(a)=P(t(k)&gt;\sqrt {\frac{a^2 k}{k+1-a^2}})
\end{align*}\]</span> for k = 4 : 25, 100, 500, 1000, where t(k) is a Student t random variable with k degrees of freedom. (These intersection points determine the critical values for a t-test for scale-mixture errors proposed by Sz´ekely [260].)</p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<p>Answer 1</p>
<p>Now, I will limit the maximum number of extreme points based on the quantile at 0.95. According to the number of known samples, the corresponding number value of 0.95 bits is obtained, and after taking the whole and minus one is taken as my new judgment condition.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="kw">set.seed</span>(<span class="dv">980904</span>)</span>
<span id="cb45-2"><a href="#cb45-2"></a></span>
<span id="cb45-3"><a href="#cb45-3"></a>rw.Metropolis=<span class="cf">function</span>(sigma, x0, N) {</span>
<span id="cb45-4"><a href="#cb45-4"></a>    x=<span class="kw">numeric</span>(N)</span>
<span id="cb45-5"><a href="#cb45-5"></a>    x[<span class="dv">1</span>]=x0</span>
<span id="cb45-6"><a href="#cb45-6"></a>    u=<span class="kw">runif</span>(N)</span>
<span id="cb45-7"><a href="#cb45-7"></a>    k=<span class="dv">0</span></span>
<span id="cb45-8"><a href="#cb45-8"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N){</span>
<span id="cb45-9"><a href="#cb45-9"></a>        y=<span class="kw">rnorm</span>(<span class="dv">1</span>,x[i<span class="dv">-1</span>],sigma)</span>
<span id="cb45-10"><a href="#cb45-10"></a>            <span class="cf">if</span>(u[i]<span class="op">&lt;=</span>((<span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(y)))<span class="op">/</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x[i<span class="dv">-1</span>])))))</span>
<span id="cb45-11"><a href="#cb45-11"></a>                x[i]=y  </span>
<span id="cb45-12"><a href="#cb45-12"></a>            <span class="cf">else</span>{</span>
<span id="cb45-13"><a href="#cb45-13"></a>                x[i]=x[i<span class="dv">-1</span>]</span>
<span id="cb45-14"><a href="#cb45-14"></a>                k=k<span class="op">+</span><span class="dv">1</span></span>
<span id="cb45-15"><a href="#cb45-15"></a>            }</span>
<span id="cb45-16"><a href="#cb45-16"></a>        }</span>
<span id="cb45-17"><a href="#cb45-17"></a>    <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x,<span class="dt">k=</span>k))</span>
<span id="cb45-18"><a href="#cb45-18"></a>}</span>
<span id="cb45-19"><a href="#cb45-19"></a></span>
<span id="cb45-20"><a href="#cb45-20"></a>N=<span class="dv">2000</span></span>
<span id="cb45-21"><a href="#cb45-21"></a>sigma=<span class="kw">c</span>(.<span class="dv">05</span>,.<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">16</span>)</span>
<span id="cb45-22"><a href="#cb45-22"></a></span>
<span id="cb45-23"><a href="#cb45-23"></a>x0=<span class="dv">25</span></span>
<span id="cb45-24"><a href="#cb45-24"></a>rw1=<span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>],x0,N)</span>
<span id="cb45-25"><a href="#cb45-25"></a>rw2=<span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>],x0,N)</span>
<span id="cb45-26"><a href="#cb45-26"></a>rw3=<span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>],x0,N)</span>
<span id="cb45-27"><a href="#cb45-27"></a>rw4=<span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>],x0,N)</span>
<span id="cb45-28"><a href="#cb45-28"></a></span>
<span id="cb45-29"><a href="#cb45-29"></a><span class="co">#number of candidate points rejected</span></span>
<span id="cb45-30"><a href="#cb45-30"></a>no.reject=<span class="kw">data.frame</span>(<span class="dt">sigma=</span>sigma,<span class="dt">no.reject=</span><span class="kw">c</span>(rw1<span class="op">$</span>k,rw2<span class="op">$</span>k,rw3<span class="op">$</span>k,rw4<span class="op">$</span>k))</span>
<span id="cb45-31"><a href="#cb45-31"></a>knitr<span class="op">::</span><span class="kw">kable</span>(no.reject)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">sigma</th>
<th align="right">no.reject</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.05</td>
<td align="right">37</td>
</tr>
<tr class="even">
<td align="right">0.50</td>
<td align="right">364</td>
</tr>
<tr class="odd">
<td align="right">2.00</td>
<td align="right">945</td>
</tr>
<tr class="even">
<td align="right">16.00</td>
<td align="right">1835</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>refline=<span class="kw">c</span>(<span class="kw">log</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">20</span>),<span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">20</span>))</span>
<span id="cb46-2"><a href="#cb46-2"></a>rw=<span class="kw">cbind</span>(rw1<span class="op">$</span>x, rw2<span class="op">$</span>x, rw3<span class="op">$</span>x,  rw4<span class="op">$</span>x)</span>
<span id="cb46-3"><a href="#cb46-3"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</span>
<span id="cb46-4"><a href="#cb46-4"></a>        <span class="kw">plot</span>(rw[,j], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb46-5"><a href="#cb46-5"></a>            <span class="dt">xlab=</span><span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(<span class="kw">round</span>(sigma[j],<span class="dv">3</span>))),</span>
<span id="cb46-6"><a href="#cb46-6"></a>            <span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>, <span class="dt">ylim=</span><span class="kw">range</span>(rw[,j]))</span>
<span id="cb46-7"><a href="#cb46-7"></a>        <span class="kw">abline</span>(<span class="dt">h=</span>refline)</span>
<span id="cb46-8"><a href="#cb46-8"></a>    }</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a>a=<span class="kw">c</span>(.<span class="dv">05</span>, <span class="kw">seq</span>(.<span class="dv">1</span>, <span class="fl">.9</span>, <span class="fl">.1</span>), <span class="fl">.95</span>)</span>
<span id="cb47-2"><a href="#cb47-2"></a>Q=<span class="kw">c</span>(<span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>a[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>]),<span class="op">-</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>a[<span class="dv">7</span><span class="op">:</span><span class="dv">11</span>])))</span>
<span id="cb47-3"><a href="#cb47-3"></a>rw=<span class="kw">cbind</span>(rw1<span class="op">$</span>x, rw2<span class="op">$</span>x, rw3<span class="op">$</span>x, rw4<span class="op">$</span>x)</span>
<span id="cb47-4"><a href="#cb47-4"></a>mc=rw[<span class="dv">501</span><span class="op">:</span>N, ]</span>
<span id="cb47-5"><a href="#cb47-5"></a>Qrw=<span class="kw">apply</span>(mc, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="kw">quantile</span>(x, a))</span>
<span id="cb47-6"><a href="#cb47-6"></a>qq=<span class="kw">data.frame</span>(<span class="kw">round</span>(<span class="kw">cbind</span>(Q, Qrw), <span class="dv">3</span>))</span>
<span id="cb47-7"><a href="#cb47-7"></a><span class="kw">names</span>(qq)=<span class="kw">c</span>(<span class="st">&#39;True&#39;</span>,<span class="st">&#39;sigma=0.05&#39;</span>,<span class="st">&#39;sigma=0.5&#39;</span>,<span class="st">&#39;sigma=2&#39;</span>,<span class="st">&#39;sigma=16&#39;</span>)</span>
<span id="cb47-8"><a href="#cb47-8"></a>knitr<span class="op">::</span><span class="kw">kable</span>(qq)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">True</th>
<th align="right">sigma=0.05</th>
<th align="right">sigma=0.5</th>
<th align="right">sigma=2</th>
<th align="right">sigma=16</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">5%</td>
<td align="right">-2.303</td>
<td align="right">23.513</td>
<td align="right">-1.779</td>
<td align="right">-1.806</td>
<td align="right">-2.359</td>
</tr>
<tr class="even">
<td align="left">10%</td>
<td align="right">-1.609</td>
<td align="right">23.825</td>
<td align="right">-1.356</td>
<td align="right">-1.322</td>
<td align="right">-2.073</td>
</tr>
<tr class="odd">
<td align="left">20%</td>
<td align="right">-0.916</td>
<td align="right">24.009</td>
<td align="right">-0.744</td>
<td align="right">-0.771</td>
<td align="right">-0.985</td>
</tr>
<tr class="even">
<td align="left">30%</td>
<td align="right">-0.511</td>
<td align="right">24.132</td>
<td align="right">-0.465</td>
<td align="right">-0.410</td>
<td align="right">-0.676</td>
</tr>
<tr class="odd">
<td align="left">40%</td>
<td align="right">-0.223</td>
<td align="right">24.219</td>
<td align="right">-0.206</td>
<td align="right">-0.197</td>
<td align="right">-0.517</td>
</tr>
<tr class="even">
<td align="left">50%</td>
<td align="right">0.000</td>
<td align="right">24.302</td>
<td align="right">-0.019</td>
<td align="right">0.006</td>
<td align="right">-0.292</td>
</tr>
<tr class="odd">
<td align="left">60%</td>
<td align="right">0.223</td>
<td align="right">24.418</td>
<td align="right">0.180</td>
<td align="right">0.211</td>
<td align="right">-0.092</td>
</tr>
<tr class="even">
<td align="left">70%</td>
<td align="right">0.511</td>
<td align="right">24.620</td>
<td align="right">0.467</td>
<td align="right">0.539</td>
<td align="right">0.466</td>
</tr>
<tr class="odd">
<td align="left">80%</td>
<td align="right">0.916</td>
<td align="right">24.806</td>
<td align="right">0.921</td>
<td align="right">0.987</td>
<td align="right">0.966</td>
</tr>
<tr class="even">
<td align="left">90%</td>
<td align="right">1.609</td>
<td align="right">24.992</td>
<td align="right">2.604</td>
<td align="right">1.559</td>
<td align="right">1.871</td>
</tr>
<tr class="odd">
<td align="left">95%</td>
<td align="right">2.303</td>
<td align="right">25.125</td>
<td align="right">4.380</td>
<td align="right">2.176</td>
<td align="right">2.311</td>
</tr>
</tbody>
</table>
<p>Answer 2</p>
<p>This question, I will only compute it when <span class="math inline">\(\sigma=2\)</span>.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>Gelman.Rubin=<span class="cf">function</span>(psi) {</span>
<span id="cb48-2"><a href="#cb48-2"></a>    <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb48-3"><a href="#cb48-3"></a>    <span class="co"># for chain in i-th row of X</span></span>
<span id="cb48-4"><a href="#cb48-4"></a>    psi=<span class="kw">as.matrix</span>(psi)</span>
<span id="cb48-5"><a href="#cb48-5"></a>    n=<span class="kw">ncol</span>(psi)</span>
<span id="cb48-6"><a href="#cb48-6"></a>    k=<span class="kw">nrow</span>(psi)</span>
<span id="cb48-7"><a href="#cb48-7"></a></span>
<span id="cb48-8"><a href="#cb48-8"></a>    psi.means=<span class="kw">rowMeans</span>(psi)     <span class="co">#row means</span></span>
<span id="cb48-9"><a href="#cb48-9"></a>    B=n<span class="op">*</span><span class="kw">var</span>(psi.means)        <span class="co">#between variance est.</span></span>
<span id="cb48-10"><a href="#cb48-10"></a>    psi.w=<span class="kw">apply</span>(psi,<span class="dv">1</span>,<span class="st">&quot;var&quot;</span>)  <span class="co">#within variances</span></span>
<span id="cb48-11"><a href="#cb48-11"></a>    W=<span class="kw">mean</span>(psi.w)               <span class="co">#within est.</span></span>
<span id="cb48-12"><a href="#cb48-12"></a>    v.hat=W<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>n)     <span class="co">#upper variance est.</span></span>
<span id="cb48-13"><a href="#cb48-13"></a>    r.hat=v.hat<span class="op">/</span>W             <span class="co">#G-R statistic</span></span>
<span id="cb48-14"><a href="#cb48-14"></a>    <span class="kw">return</span>(r.hat)</span>
<span id="cb48-15"><a href="#cb48-15"></a>}</span>
<span id="cb48-16"><a href="#cb48-16"></a></span>
<span id="cb48-17"><a href="#cb48-17"></a>rw.Metropolis=<span class="cf">function</span>(sigma, x0, N) {</span>
<span id="cb48-18"><a href="#cb48-18"></a>    x=<span class="kw">numeric</span>(N)</span>
<span id="cb48-19"><a href="#cb48-19"></a>    x[<span class="dv">1</span>]=x0</span>
<span id="cb48-20"><a href="#cb48-20"></a>    u=<span class="kw">runif</span>(N)</span>
<span id="cb48-21"><a href="#cb48-21"></a>    k=<span class="dv">0</span></span>
<span id="cb48-22"><a href="#cb48-22"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N){</span>
<span id="cb48-23"><a href="#cb48-23"></a>        y=<span class="kw">rnorm</span>(<span class="dv">1</span>,x[i<span class="dv">-1</span>],sigma)</span>
<span id="cb48-24"><a href="#cb48-24"></a>            <span class="cf">if</span>(u[i]<span class="op">&lt;=</span>((<span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(y)))<span class="op">/</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x[i<span class="dv">-1</span>])))))</span>
<span id="cb48-25"><a href="#cb48-25"></a>                x[i]=y  </span>
<span id="cb48-26"><a href="#cb48-26"></a>            <span class="cf">else</span>{</span>
<span id="cb48-27"><a href="#cb48-27"></a>                x[i]=x[i<span class="dv">-1</span>]</span>
<span id="cb48-28"><a href="#cb48-28"></a>                k=k<span class="op">+</span><span class="dv">1</span></span>
<span id="cb48-29"><a href="#cb48-29"></a>            }</span>
<span id="cb48-30"><a href="#cb48-30"></a>        }</span>
<span id="cb48-31"><a href="#cb48-31"></a>    <span class="kw">return</span>(x)</span>
<span id="cb48-32"><a href="#cb48-32"></a>}</span>
<span id="cb48-33"><a href="#cb48-33"></a></span>
<span id="cb48-34"><a href="#cb48-34"></a>sigma=<span class="dv">2</span>     <span class="co">#parameter of proposal distribution</span></span>
<span id="cb48-35"><a href="#cb48-35"></a>k=<span class="st"> </span><span class="dv">4</span>          <span class="co">#number of chains to generate</span></span>
<span id="cb48-36"><a href="#cb48-36"></a>n=<span class="dv">15000</span>      <span class="co">#length of chains</span></span>
<span id="cb48-37"><a href="#cb48-37"></a>b=<span class="dv">1000</span>       <span class="co">#burn-in length</span></span>
<span id="cb48-38"><a href="#cb48-38"></a></span>
<span id="cb48-39"><a href="#cb48-39"></a><span class="co">#choose overdispersed initial values</span></span>
<span id="cb48-40"><a href="#cb48-40"></a>x0=<span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">-5</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb48-41"><a href="#cb48-41"></a></span>
<span id="cb48-42"><a href="#cb48-42"></a><span class="co">#generate the chains</span></span>
<span id="cb48-43"><a href="#cb48-43"></a><span class="kw">set.seed</span>(<span class="dv">980904</span>)</span>
<span id="cb48-44"><a href="#cb48-44"></a>X=<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span>k,<span class="dt">ncol=</span>n)</span>
<span id="cb48-45"><a href="#cb48-45"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb48-46"><a href="#cb48-46"></a>    X[i, ]=<span class="kw">rw.Metropolis</span>(sigma,x0[i],n)</span>
<span id="cb48-47"><a href="#cb48-47"></a></span>
<span id="cb48-48"><a href="#cb48-48"></a><span class="co">#compute diagnostic statistics</span></span>
<span id="cb48-49"><a href="#cb48-49"></a>psi=<span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb48-50"><a href="#cb48-50"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</span>
<span id="cb48-51"><a href="#cb48-51"></a>    psi[i,]=psi[i,]<span class="op">/</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb48-52"><a href="#cb48-52"></a></span>
<span id="cb48-53"><a href="#cb48-53"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb48-54"><a href="#cb48-54"></a>  <span class="cf">if</span>(i<span class="op">==</span><span class="dv">1</span>){</span>
<span id="cb48-55"><a href="#cb48-55"></a>    <span class="kw">plot</span>((b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,psi[i,(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n],<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.2</span>,<span class="fl">0.2</span>),<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb48-56"><a href="#cb48-56"></a>        <span class="dt">xlab=</span><span class="st">&#39;Index&#39;</span>,<span class="dt">ylab=</span><span class="kw">bquote</span>(phi))</span>
<span id="cb48-57"><a href="#cb48-57"></a>  }<span class="cf">else</span>{</span>
<span id="cb48-58"><a href="#cb48-58"></a>    <span class="kw">lines</span>(psi[i,(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n],<span class="dt">col=</span>i)</span>
<span id="cb48-59"><a href="#cb48-59"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAApVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrYil+Y6AAA6ADo6AGY6Ojo6OmY6ZmY6ZrY6kNth0E9mAABmADpmOgBmOjpmZjpmZmZmZpBmtrZmtv+QOgCQZgCQZmaQkGaQtraQttuQ2/+2ZgC2Zjq2tpC2tra2ttu229u22/+2/7a2///bkDrbkGbbtrbb/9vb///fU2v/tmb/25D/27b/29v//7b//9v///+ojqNYAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJ+klEQVR4nO2dCXvbNACGvUHrcc7h6GgZsEA5FsaSQar//9OwTsuH/MmHYq393j1LnFiWpTc6baUpBBml2DoBuUNBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCDANEGHoihu1cbzt0mSkx+TBB2evRHn3bWgoGEe7l6qx6v3FDTIeaeql9hfvaegIXQJqtlfU9AgVst5V1DQIAfdh9VlKSCo+GhII+jS0aWDggCpBYUaaQoKxDK5am8NqxiAggCJBD3c6YoUHAU9cUGHwgylT3ZjUXRbkkSQm2rUquoJ69LoNiWJIDtZrTmxmx+AJQhhp2Jsg0LU03hFoPxQ0KWjSwcFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBOCdVQBLEICCABQEoCAABQEoCEBBAAoC5CGorP8J9z9IObo3DZkIKmXeS/0UorT7S/Ny3RQF+HgElaU1pB5HXc6mH2kWgkqTZWGyPZj30j2VjasF+HGY56EoMxDkioV5ESgcTpBzGG2oG2Fpq2vZYTyh4yQVVAib3WBS7VtO5PAH7h3gwjsT3hlLL1i4+Ij8BIWKkHunk8+gI1tZvXar7MUwLaErBVRMWQZcC2ldHipNr+9eipFMtd43DZnwmqn27hltewbLgEvRv35mstk0ycFT9UpUp7cLBY4lg0Wcg4JK94GjDsu0IKLV6oTCopSPJnSlgGLqMuBaUD/2Rg7srfqN8JrkUYK6sRftRgTkXPdTc4pHBBksA1aCis7ecsoZU046Zgh69/rVHyj0lGXAsg/Tgo5FszeXGx+TBZ2/ffbFFy8+Xfpd5o4gpeT4KAT9+ot8/PdVqGhMPm9pBB0l5u3el463szVJ0MPrm++/vFF899VNlCPwndVSN0FGUBEStOHdxmmC3t3/9upe8frn+99nFCI/43YqYAXVbx5N3dJ1Tlgn6i1f0gVVzatiD39/vfy8boakXXiCvPw7K/bBulp4/ikJnRawnmV98qJY3kg3k2wddXEUWtCxk/umHdIPF767P6Ob/+/+/k8UGk9WjSAXtRZU2zmKgCD3+qKd3GaT1a4gcVQdvUG+cicePrVtjsbS3BugD7wZitwvtzGsPdXwJqF6kKiVyK7MOBLCaAoKKvyc9JqmXjVsKudIZpowxcjJhw6MDSjiJqve9LIlyBQnreg4eKyXJi8jfh9nmnLRqautpn4gLhNbW/N4EmYEFFNKUBN114VXjsJpKgrhKk4h7JyucdVk1XfSkyBcoRkSF8nKk9WyI6inQpcgVITcaMmWFp13r9q1n/1D25Uz1DalEYQnq/6FnkFBGiDIJC3cEDW1bfBAG2gs8pgUTAoYh76a2kS9TJCXutGi0j9QAD8bChKrCZqPP+IMpCATQaHGBjXTCHC4G3LZjX7wTQUZjiP5WCZo3K+20nSXg93mVoL86MYEzTNkh+NVUFEzYIdjrUhSChr/nGfErgtGVWPKSXsvHmE1ZCAIJHZaEdKFQh9S66kq4dcgvXOCni0FVXYTCorOTzPXVVTqvyxFzR4/sqrSZQwkNJL1BdmkrSbITuB0cJ33xoGqbt5OvcPsrkRIVQ6CcGgTZFxVe6dXOPSGX1paZadqEH1LWwoyiYkSpNqP0cLk7+lUHa+0aAttDb6qgYRGsrag4yRBrvVoG/KMee8P1hZbz2LanVZCVw8YGV09RpkoyDg42sLUXBLxxU3MP07o6gEjo1OCKjUNw6H9i2ed/ujY6bdX9rOtoKoanIahPKoBsvAql196KvEkBI1lc7gVmd66xHFhQe66eVFVRyWoWbHgqFw33MmvN7TpmhjsoldJ8eoBI6Or1FxJ3sIYEOTGJp0dTSdthjbenpWrlkvo6gHjkO2IEiQGBaknT5EuTlXTR5lxjQmdpvAo8hHU5LGRYuuZV6DaxqpQk7QaWwqqM3d0gqohQbYUVc5WE8gMjkWyyqXZWlClrplX7fbEPOsXgXlka66ZkPwEdSdK/bd6+1OysaA66zLiyjYqFygSE9lckCpArjVZfaawmO3GQUJfNaagQHT6YnEhBZmGuLKDnazYUJDQguwweHBysT2ZCHKF56kIgj8CqQTJp8K2QMLdgsiKROuD4I9AhgRNOctFSLjCbPRHIJ0gUTVDwey6MJFIUMSPQBaVfepOQTMj7RrF8I9AVlZQb46eGYnaIPgjkMaEvLKYnxSfZL0Y+BHIRtCkeC/PVuMgJ2jdaNeHggCpBQUbaRPrkxcUgoIAFBSIxd03XDPWlCQSBL9Ql3vv7kg0UIRfqHvagvgTfgD+CCQgpgR9NKQQFPGFutgTTHk3XRQxTDsSfqEu9gSPVdBqJ3jUgrymaPYJKAicgILACSgInICCwAketaA1TkBBjwYKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEWFuQujmtLoeciuLZm+ENgFuNPTOKD5/bm3Z7dXdhfkrE6oIe7uoTH4rrOg31hvw/sAGQq7FP0tDMKM47e1fzpG6/zE+JZGVBH17Ij/7w/K2+qra/Fv0NwMPddejIqChObm3FeScFzU+JIkkbVH86zlR/AxzsBM2L4lS8tPfFD1c/1oLmp0SRRNC+TsRnsgSfhjbQ0baKzY7CBKhDyzZoQUokKQTJG9O6iteP/Y2I4wvbUsyKQmddViQpaElKRBJBJ9tGz0xWXf7qerHAsRYk11dkKUgvbJhfsJumYlEVU2FzrGJmFdr8ptF9vrOjUFk/mGUut5k10s2XFeZ2rjr5pwUjhaZs7LPr5mXbYVI5e3hm26DZUbQF5TVQNAVbnvxgh/P9DcDezlZmRtERtCAlgpNVCAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAiQn6DeqoLYZQZpoCAABQGyFHTe/bDTi+3lOpWfzGIauSRGLgs776b8YYOlZCpIrtev/8u1VKfCvJCLquTisNBfv0pDpoJeqqV4ejXe3ryhFkadnv/1zUVrXKaCbtWflNNLxdzCXeVrX8StLVyLrAUdnCC7ZFXor7lckKwFdUqQ5OHuJm757lpkLcgsaDZvKA5X/0z66zyLyVqQ+V6L6cV0a30bu0R+JfIW1B4H1WL0yvBLNtP5CcoMCgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgI8D/X4C/25IibtQAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb49-2"><a href="#cb49-2"></a>pen=<span class="dv">0</span></span>
<span id="cb49-3"><a href="#cb49-3"></a>rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb49-4"><a href="#cb49-4"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n){</span>
<span id="cb49-5"><a href="#cb49-5"></a>    rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb49-6"><a href="#cb49-6"></a>    <span class="cf">if</span>(pen<span class="op">==</span><span class="dv">0</span><span class="op">&amp;</span>rhat[j]<span class="op">&lt;=</span><span class="fl">1.1</span>) {pen=j;}</span>
<span id="cb49-7"><a href="#cb49-7"></a>}</span>
<span id="cb49-8"><a href="#cb49-8"></a>    </span>
<span id="cb49-9"><a href="#cb49-9"></a><span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb49-10"><a href="#cb49-10"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.1</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="kw">print</span>(pen)</span></code></pre></div>
<pre><code>## [1] 1812</code></pre>
<p>Answer 3</p>
<p>First, we know is that the T-distribution is symmetric around the Y-axis. So, So x=0 is a solution to this. According to the characteristics of the T distribution, the above equation has one and only one solution on the positive x axis, and one symmetric solution on the negative x axis.so we only need to calculate the solution on the positive x axis.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>compute=<span class="cf">function</span>(n){</span>
<span id="cb52-2"><a href="#cb52-2"></a>  k=n</span>
<span id="cb52-3"><a href="#cb52-3"></a>  f=<span class="cf">function</span>(x){</span>
<span id="cb52-4"><a href="#cb52-4"></a>    (<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(x<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k<span class="dv">-1</span>)<span class="op">/</span>(k<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span>)),k<span class="dv">-1</span>))<span class="op">-</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(x<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>x<span class="op">^</span><span class="dv">2</span>)),k))</span>
<span id="cb52-5"><a href="#cb52-5"></a>  }</span>
<span id="cb52-6"><a href="#cb52-6"></a>  res1=<span class="kw">uniroot</span>(f,<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="kw">sqrt</span>(k)<span class="op">-</span><span class="fl">0.1</span>))</span>
<span id="cb52-7"><a href="#cb52-7"></a>  <span class="kw">return</span>(res1<span class="op">$</span>root)</span>
<span id="cb52-8"><a href="#cb52-8"></a>}</span>
<span id="cb52-9"><a href="#cb52-9"></a>n=<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb52-10"><a href="#cb52-10"></a>root=<span class="kw">numeric</span>(<span class="kw">length</span>(n))</span>
<span id="cb52-11"><a href="#cb52-11"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)){</span>
<span id="cb52-12"><a href="#cb52-12"></a>  root[i]=<span class="kw">compute</span>(n[i])</span>
<span id="cb52-13"><a href="#cb52-13"></a>}</span>
<span id="cb52-14"><a href="#cb52-14"></a>rw=<span class="kw">round</span>(<span class="kw">cbind</span>(n,<span class="op">-</span>root,<span class="kw">numeric</span>(<span class="kw">length</span>(root)),root),<span class="dv">3</span>)</span>
<span id="cb52-15"><a href="#cb52-15"></a>qq=<span class="kw">data.frame</span>(rw)</span>
<span id="cb52-16"><a href="#cb52-16"></a><span class="kw">names</span>(qq)=<span class="kw">c</span>(<span class="st">&#39;k&#39;</span>,<span class="st">&#39;The first solution&#39;</span>,<span class="st">&#39;The second solution&#39;</span>,<span class="st">&#39;The third solution&#39;</span>)</span>
<span id="cb52-17"><a href="#cb52-17"></a>knitr<span class="op">::</span><span class="kw">kable</span>(qq)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">k</th>
<th align="right">The first solution</th>
<th align="right">The second solution</th>
<th align="right">The third solution</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">4</td>
<td align="right">-1.492</td>
<td align="right">0</td>
<td align="right">1.492</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">-1.534</td>
<td align="right">0</td>
<td align="right">1.534</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">-1.563</td>
<td align="right">0</td>
<td align="right">1.563</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">-1.584</td>
<td align="right">0</td>
<td align="right">1.584</td>
</tr>
<tr class="odd">
<td align="right">8</td>
<td align="right">-1.601</td>
<td align="right">0</td>
<td align="right">1.601</td>
</tr>
<tr class="even">
<td align="right">9</td>
<td align="right">-1.615</td>
<td align="right">0</td>
<td align="right">1.615</td>
</tr>
<tr class="odd">
<td align="right">10</td>
<td align="right">-1.625</td>
<td align="right">0</td>
<td align="right">1.625</td>
</tr>
<tr class="even">
<td align="right">11</td>
<td align="right">-1.634</td>
<td align="right">0</td>
<td align="right">1.634</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="right">-1.642</td>
<td align="right">0</td>
<td align="right">1.642</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">-1.649</td>
<td align="right">0</td>
<td align="right">1.649</td>
</tr>
<tr class="odd">
<td align="right">14</td>
<td align="right">-1.654</td>
<td align="right">0</td>
<td align="right">1.654</td>
</tr>
<tr class="even">
<td align="right">15</td>
<td align="right">-1.659</td>
<td align="right">0</td>
<td align="right">1.659</td>
</tr>
<tr class="odd">
<td align="right">16</td>
<td align="right">-1.663</td>
<td align="right">0</td>
<td align="right">1.663</td>
</tr>
<tr class="even">
<td align="right">17</td>
<td align="right">-1.667</td>
<td align="right">0</td>
<td align="right">1.667</td>
</tr>
<tr class="odd">
<td align="right">18</td>
<td align="right">-1.671</td>
<td align="right">0</td>
<td align="right">1.671</td>
</tr>
<tr class="even">
<td align="right">19</td>
<td align="right">-1.674</td>
<td align="right">0</td>
<td align="right">1.674</td>
</tr>
<tr class="odd">
<td align="right">20</td>
<td align="right">-1.677</td>
<td align="right">0</td>
<td align="right">1.677</td>
</tr>
<tr class="even">
<td align="right">21</td>
<td align="right">-1.679</td>
<td align="right">0</td>
<td align="right">1.679</td>
</tr>
<tr class="odd">
<td align="right">22</td>
<td align="right">-1.681</td>
<td align="right">0</td>
<td align="right">1.681</td>
</tr>
<tr class="even">
<td align="right">23</td>
<td align="right">-1.684</td>
<td align="right">0</td>
<td align="right">1.684</td>
</tr>
<tr class="odd">
<td align="right">24</td>
<td align="right">-1.686</td>
<td align="right">0</td>
<td align="right">1.686</td>
</tr>
<tr class="even">
<td align="right">25</td>
<td align="right">-1.687</td>
<td align="right">0</td>
<td align="right">1.687</td>
</tr>
<tr class="odd">
<td align="right">100</td>
<td align="right">-9.900</td>
<td align="right">0</td>
<td align="right">9.900</td>
</tr>
<tr class="even">
<td align="right">500</td>
<td align="right">-22.261</td>
<td align="right">0</td>
<td align="right">22.261</td>
</tr>
<tr class="odd">
<td align="right">1000</td>
<td align="right">-31.523</td>
<td align="right">0</td>
<td align="right">31.523</td>
</tr>
</tbody>
</table>
<p>So for the problem, the solution we need is the solution in the third column.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>compute=<span class="cf">function</span>(n){</span>
<span id="cb53-2"><a href="#cb53-2"></a>  k=n</span>
<span id="cb53-3"><a href="#cb53-3"></a>  f=<span class="cf">function</span>(x){</span>
<span id="cb53-4"><a href="#cb53-4"></a>    (<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(x<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k<span class="dv">-1</span>)<span class="op">/</span>(k<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span>)),k<span class="dv">-1</span>))<span class="op">-</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(x<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>x<span class="op">^</span><span class="dv">2</span>)),k))</span>
<span id="cb53-5"><a href="#cb53-5"></a>  }</span>
<span id="cb53-6"><a href="#cb53-6"></a>  res1=<span class="kw">uniroot</span>(f,<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="kw">sqrt</span>(k)<span class="op">-</span><span class="fl">0.1</span>))</span>
<span id="cb53-7"><a href="#cb53-7"></a>  <span class="kw">return</span>(res1<span class="op">$</span>root)</span>
<span id="cb53-8"><a href="#cb53-8"></a>}</span>
<span id="cb53-9"><a href="#cb53-9"></a>n=<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb53-10"><a href="#cb53-10"></a>root=<span class="kw">numeric</span>(<span class="kw">length</span>(n))</span>
<span id="cb53-11"><a href="#cb53-11"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)){</span>
<span id="cb53-12"><a href="#cb53-12"></a>  root[i]=<span class="kw">compute</span>(n[i])</span>
<span id="cb53-13"><a href="#cb53-13"></a>}</span>
<span id="cb53-14"><a href="#cb53-14"></a>rw=<span class="kw">round</span>(<span class="kw">cbind</span>(n,root),<span class="dv">3</span>)</span>
<span id="cb53-15"><a href="#cb53-15"></a>qq=<span class="kw">data.frame</span>(rw)</span>
<span id="cb53-16"><a href="#cb53-16"></a><span class="kw">names</span>(qq)=<span class="kw">c</span>(<span class="st">&#39;k&#39;</span>,<span class="st">&#39;solution&#39;</span>)</span>
<span id="cb53-17"><a href="#cb53-17"></a>knitr<span class="op">::</span><span class="kw">kable</span>(qq)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">k</th>
<th align="right">solution</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">4</td>
<td align="right">1.492</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">1.534</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">1.563</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">1.584</td>
</tr>
<tr class="odd">
<td align="right">8</td>
<td align="right">1.601</td>
</tr>
<tr class="even">
<td align="right">9</td>
<td align="right">1.615</td>
</tr>
<tr class="odd">
<td align="right">10</td>
<td align="right">1.625</td>
</tr>
<tr class="even">
<td align="right">11</td>
<td align="right">1.634</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="right">1.642</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">1.649</td>
</tr>
<tr class="odd">
<td align="right">14</td>
<td align="right">1.654</td>
</tr>
<tr class="even">
<td align="right">15</td>
<td align="right">1.659</td>
</tr>
<tr class="odd">
<td align="right">16</td>
<td align="right">1.663</td>
</tr>
<tr class="even">
<td align="right">17</td>
<td align="right">1.667</td>
</tr>
<tr class="odd">
<td align="right">18</td>
<td align="right">1.671</td>
</tr>
<tr class="even">
<td align="right">19</td>
<td align="right">1.674</td>
</tr>
<tr class="odd">
<td align="right">20</td>
<td align="right">1.677</td>
</tr>
<tr class="even">
<td align="right">21</td>
<td align="right">1.679</td>
</tr>
<tr class="odd">
<td align="right">22</td>
<td align="right">1.681</td>
</tr>
<tr class="even">
<td align="right">23</td>
<td align="right">1.684</td>
</tr>
<tr class="odd">
<td align="right">24</td>
<td align="right">1.686</td>
</tr>
<tr class="even">
<td align="right">25</td>
<td align="right">1.687</td>
</tr>
<tr class="odd">
<td align="right">100</td>
<td align="right">9.900</td>
</tr>
<tr class="even">
<td align="right">500</td>
<td align="right">22.261</td>
</tr>
<tr class="odd">
<td align="right">1000</td>
<td align="right">31.523</td>
</tr>
</tbody>
</table>
</div>
<div id="question-7" class="section level2">
<h2>Question</h2>
<p>1.A-B-O blood type problem Let the three alleles be A, B, and O.</p>
<table>
<thead>
<tr class="header">
<th align="center">Genotype</th>
<th align="center">AA</th>
<th align="center">BB</th>
<th align="center">OO</th>
<th align="center">AO</th>
<th align="center">BO</th>
<th align="center">AB</th>
<th align="center">Sum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Frequency</td>
<td align="center">p^2</td>
<td align="center">q^2</td>
<td align="center">r^2</td>
<td align="center">2pr</td>
<td align="center">2qr</td>
<td align="center">2pq</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">Count</td>
<td align="center">nAA</td>
<td align="center">nBB</td>
<td align="center">nOO</td>
<td align="center">nAO</td>
<td align="center">nBO</td>
<td align="center">nAB</td>
<td align="center">n</td>
</tr>
</tbody>
</table>
<p>Observed data: <span class="math inline">\(n_{A\cdot}=n_{AA}+n_{AO}=444\)</span>(A-type), <span class="math inline">\(n_{B\cdot}=n_{BB}+n_{BO}=132\)</span>(B-type), <span class="math inline">\(n_{OO}=361\)</span>(O-type), <span class="math inline">\(n_{AB}=63\)</span>(AB-type).</p>
<p>Use EM algorithm to solve MLE of p and q(consider missing data <span class="math inline">\(n_{AA}\)</span> and <span class="math inline">\(n_{BB}\)</span>)</p>
<p>Record the values of p and q that maximize the conditional likelihood in each EM steps, calculate the corresponding log-maximum likelihood values (for observed data), are they increasing?</p>
<p>2.Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list:</p>
<p>formulas &lt;- list( map ~ disp, map ~ I(1/disp), map ~ disp+wt, map ~ I(1/disp)+wt )</p>
<p>3.The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial.</p>
<p>trials &lt;- replicate( 100, t.test(rpois(10,10), rpois(7,10)), simplify = FALSE ) Extra challenge: get rid of the anonymous function by using [directly].</p>
<p>4.Implement a combination of Map() and vapply() to create an lapply() variant that iterates in parallel over all of its inputs and stores its outputs in a vector (or a matrix). What arguments should the function take?</p>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<p>Answer 1</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="kw">library</span>(StatComp20083)</span></code></pre></div>
<pre><code>## 
## 载入程辑包：&#39;StatComp20083&#39;</code></pre>
<pre><code>## The following object is masked _by_ &#39;.GlobalEnv&#39;:
## 
##     rw.Metropolis</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="kw">HW8_1</span>()</span></code></pre></div>
<pre><code>## [1] 0.2976404 0.1027092</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>we can find they are increasing.</p>
<p>Answer 2</p>
<p>this is “for()”’s answer.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="kw">library</span>(DAAG)</span>
<span id="cb59-2"><a href="#cb59-2"></a>formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb59-3"><a href="#cb59-3"></a>  mpg <span class="op">~</span><span class="st"> </span>disp,</span>
<span id="cb59-4"><a href="#cb59-4"></a>  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span><span class="op">/</span>disp),</span>
<span id="cb59-5"><a href="#cb59-5"></a>  mpg <span class="op">~</span><span class="st"> </span>disp<span class="op">+</span>wt,</span>
<span id="cb59-6"><a href="#cb59-6"></a>  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span><span class="op">/</span>disp)<span class="op">+</span>wt</span>
<span id="cb59-7"><a href="#cb59-7"></a>)</span>
<span id="cb59-8"><a href="#cb59-8"></a>mpg=mtcars<span class="op">$</span>mpg</span>
<span id="cb59-9"><a href="#cb59-9"></a>disp=mtcars<span class="op">$</span>disp</span>
<span id="cb59-10"><a href="#cb59-10"></a>wt=mtcars<span class="op">$</span>wt</span>
<span id="cb59-11"><a href="#cb59-11"></a>lanswer=foranswer=<span class="kw">c</span>(<span class="ot">NA</span>)</span>
<span id="cb59-12"><a href="#cb59-12"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(formulas)){</span>
<span id="cb59-13"><a href="#cb59-13"></a>  foranswer=<span class="kw">c</span>(foranswer,<span class="kw">as.numeric</span>(<span class="kw">lm</span>(<span class="kw">as.character</span>(formulas[i]))<span class="op">$</span>coefficients),<span class="ot">NA</span>)</span>
<span id="cb59-14"><a href="#cb59-14"></a>}</span>
<span id="cb59-15"><a href="#cb59-15"></a><span class="kw">print</span>(foranswer)</span></code></pre></div>
<pre><code>##  [1]            NA   29.59985476   -0.04121512            NA   10.75201803
##  [6] 1557.67393438            NA   34.96055404   -0.01772474   -3.35082533
## [11]            NA   19.02420622 1142.55997485   -1.79764901            NA</code></pre>
<p>this is “lapply()”’s answer.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a>f=<span class="cf">function</span>(x){</span>
<span id="cb61-2"><a href="#cb61-2"></a>  <span class="kw">return</span>(<span class="kw">as.numeric</span>(<span class="kw">lm</span>(x)<span class="op">$</span>coefficients))</span>
<span id="cb61-3"><a href="#cb61-3"></a>}</span>
<span id="cb61-4"><a href="#cb61-4"></a><span class="kw">print</span>( <span class="kw">lapply</span>( formulas,f ) )</span></code></pre></div>
<pre><code>## [[1]]
## [1] 29.59985476 -0.04121512
## 
## [[2]]
## [1]   10.75202 1557.67393
## 
## [[3]]
## [1] 34.96055404 -0.01772474 -3.35082533
## 
## [[4]]
## [1]   19.024206 1142.559975   -1.797649</code></pre>
<p>Answer 3</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="kw">set.seed</span>(<span class="dv">980904</span>)</span>
<span id="cb63-2"><a href="#cb63-2"></a>trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(</span>
<span id="cb63-3"><a href="#cb63-3"></a>  <span class="dv">100</span>,</span>
<span id="cb63-4"><a href="#cb63-4"></a>  <span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>,<span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>,<span class="dv">10</span>)),</span>
<span id="cb63-5"><a href="#cb63-5"></a>  <span class="dt">simplify =</span> <span class="ot">FALSE</span></span>
<span id="cb63-6"><a href="#cb63-6"></a>)</span>
<span id="cb63-7"><a href="#cb63-7"></a><span class="kw">sapply</span>(trials,<span class="cf">function</span>(x) x<span class="op">$</span>p.value)</span></code></pre></div>
<pre><code>##   [1] 0.15496372 0.25676779 0.31278451 0.37151249 0.33398223 0.70182945
##   [7] 0.37487918 0.92224061 0.17172527 0.71504599 0.89974545 0.36959023
##  [13] 0.46697051 0.89152245 0.87237463 0.54771722 0.65842678 0.47979670
##  [19] 0.46395038 0.31968547 0.71432723 0.77426377 0.36858661 0.11844408
##  [25] 0.05654716 0.42185956 0.58960326 0.25273776 0.09301146 0.52771416
##  [31] 0.42285311 0.98456720 0.77902601 0.16782916 0.13535955 0.88715483
##  [37] 0.84105373 0.95000378 0.96137283 0.03177234 0.52492731 0.40891005
##  [43] 0.76646104 0.31725308 0.48583850 0.70654293 0.25911417 0.36063925
##  [49] 0.55361389 0.51354136 0.25328355 0.41027850 0.05036306 0.67555504
##  [55] 0.16362061 0.60265520 0.23715121 0.85187794 0.39181670 0.94521741
##  [61] 0.15648305 0.01146390 0.67996112 0.44535352 0.42759073 0.97763804
##  [67] 0.51949724 0.94424272 0.48309648 0.62104958 0.97243931 0.85036166
##  [73] 0.42021015 0.95276351 0.51283000 0.30904509 0.27832365 0.45504870
##  [79] 0.79814471 0.74471721 0.57693049 0.32503409 0.68716165 0.46894355
##  [85] 0.01366675 0.33057346 0.17599995 0.45026658 0.42301324 0.37632875
##  [91] 0.23270074 0.93017144 0.37697331 0.04234863 0.80522477 0.99378658
##  [97] 0.19822266 0.84664061 0.45813692 0.29075234</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a>f=<span class="cf">function</span>(x) x<span class="op">$</span>p.value</span>
<span id="cb65-2"><a href="#cb65-2"></a><span class="kw">sapply</span>(trials,f)</span></code></pre></div>
<pre><code>##   [1] 0.15496372 0.25676779 0.31278451 0.37151249 0.33398223 0.70182945
##   [7] 0.37487918 0.92224061 0.17172527 0.71504599 0.89974545 0.36959023
##  [13] 0.46697051 0.89152245 0.87237463 0.54771722 0.65842678 0.47979670
##  [19] 0.46395038 0.31968547 0.71432723 0.77426377 0.36858661 0.11844408
##  [25] 0.05654716 0.42185956 0.58960326 0.25273776 0.09301146 0.52771416
##  [31] 0.42285311 0.98456720 0.77902601 0.16782916 0.13535955 0.88715483
##  [37] 0.84105373 0.95000378 0.96137283 0.03177234 0.52492731 0.40891005
##  [43] 0.76646104 0.31725308 0.48583850 0.70654293 0.25911417 0.36063925
##  [49] 0.55361389 0.51354136 0.25328355 0.41027850 0.05036306 0.67555504
##  [55] 0.16362061 0.60265520 0.23715121 0.85187794 0.39181670 0.94521741
##  [61] 0.15648305 0.01146390 0.67996112 0.44535352 0.42759073 0.97763804
##  [67] 0.51949724 0.94424272 0.48309648 0.62104958 0.97243931 0.85036166
##  [73] 0.42021015 0.95276351 0.51283000 0.30904509 0.27832365 0.45504870
##  [79] 0.79814471 0.74471721 0.57693049 0.32503409 0.68716165 0.46894355
##  [85] 0.01366675 0.33057346 0.17599995 0.45026658 0.42301324 0.37632875
##  [91] 0.23270074 0.93017144 0.37697331 0.04234863 0.80522477 0.99378658
##  [97] 0.19822266 0.84664061 0.45813692 0.29075234</code></pre>
<p>Answer 4</p>
<p>We use the dataset mtcars and faithful as the example, what we expect is something like the following result:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a>datalist=<span class="kw">list</span>(mtcars,faithful)</span>
<span id="cb67-2"><a href="#cb67-2"></a><span class="kw">lapply</span>(datalist,<span class="cf">function</span>(x) <span class="kw">vapply</span>(x,mean,<span class="kw">numeric</span>(<span class="dv">1</span>)))</span></code></pre></div>
<pre><code>## [[1]]
##        mpg        cyl       disp         hp       drat         wt       qsec 
##  20.090625   6.187500 230.721875 146.687500   3.596563   3.217250  17.848750 
##         vs         am       gear       carb 
##   0.437500   0.406250   3.687500   2.812500 
## 
## [[2]]
## eruptions   waiting 
##  3.487783 70.897059</code></pre>
<p>We can get similar result with a the following function:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a>mylapply=<span class="cf">function</span>(X,FUN,FUN.VALUE,<span class="dt">simplify=</span><span class="ot">FALSE</span>){</span>
<span id="cb69-2"><a href="#cb69-2"></a>  out=<span class="kw">Map</span>(<span class="cf">function</span>(x) <span class="kw">vapply</span>(x, FUN, FUN.VALUE), X)</span>
<span id="cb69-3"><a href="#cb69-3"></a>  <span class="cf">if</span>(simplify<span class="op">==</span><span class="ot">TRUE</span>) <span class="kw">return</span>(<span class="kw">simplify2array</span>(out))</span>
<span id="cb69-4"><a href="#cb69-4"></a>  <span class="kw">unlist</span>(out)</span>
<span id="cb69-5"><a href="#cb69-5"></a>}</span>
<span id="cb69-6"><a href="#cb69-6"></a><span class="kw">mylapply</span>(datalist, mean, <span class="kw">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##        mpg        cyl       disp         hp       drat         wt       qsec 
##  20.090625   6.187500 230.721875 146.687500   3.596563   3.217250  17.848750 
##         vs         am       gear       carb  eruptions    waiting 
##   0.437500   0.406250   3.687500   2.812500   3.487783  70.897059</code></pre>
</div>
<div id="question-8" class="section level2">
<h2>Question</h2>
<p>1.Write an Rcpp function for Exercise 9.4 Compare the corresponding generated random numbers with those by the R function you wrote before using the function “qqplot”. Compare the computation time of the two functions with the function “microbenchmark”. Comments your results.</p>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<p>Answer 1</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a><span class="co">#include &lt;Rcpp.h&gt;</span></span>
<span id="cb71-2"><a href="#cb71-2"></a>using namespace Rcpp;</span>
<span id="cb71-3"><a href="#cb71-3"></a><span class="co">#define PI 3.141592654</span></span>
<span id="cb71-4"><a href="#cb71-4"></a><span class="op">/</span><span class="er">/</span><span class="st"> </span>[[Rcpp<span class="op">::</span>export]]</span>
<span id="cb71-5"><a href="#cb71-5"></a>List <span class="kw">crw</span>(double sigma, double x0, int N){</span>
<span id="cb71-6"><a href="#cb71-6"></a>  std<span class="op">::</span>vector<span class="op">&lt;</span>double<span class="op">&gt;</span><span class="st"> </span>x;</span>
<span id="cb71-7"><a href="#cb71-7"></a>  std<span class="op">::</span>vector<span class="op">&lt;</span>int<span class="op">&gt;</span><span class="st"> </span>knum;</span>
<span id="cb71-8"><a href="#cb71-8"></a>  double u[N],y;</span>
<span id="cb71-9"><a href="#cb71-9"></a>  int k=<span class="dv">0</span>;</span>
<span id="cb71-10"><a href="#cb71-10"></a>  <span class="kw">x.push_back</span>(x0);</span>
<span id="cb71-11"><a href="#cb71-11"></a>  int x1=x0;</span>
<span id="cb71-12"><a href="#cb71-12"></a>  </span>
<span id="cb71-13"><a href="#cb71-13"></a>  double U,V;</span>
<span id="cb71-14"><a href="#cb71-14"></a>  int phase=<span class="dv">0</span>;</span>
<span id="cb71-15"><a href="#cb71-15"></a>  double z;</span>
<span id="cb71-16"><a href="#cb71-16"></a>  </span>
<span id="cb71-17"><a href="#cb71-17"></a>  <span class="cf">for</span>(int <span class="dt">i=</span><span class="dv">0</span>;i<span class="op">&lt;</span>N;i<span class="op">++</span>){u[i]=<span class="kw">rand</span>()<span class="op">/</span>(RAND_MAX<span class="fl">+1.0</span>);}</span>
<span id="cb71-18"><a href="#cb71-18"></a>  <span class="cf">for</span>(int <span class="dt">i=</span><span class="dv">1</span>;i<span class="op">&lt;</span>N;i<span class="op">++</span>){</span>
<span id="cb71-19"><a href="#cb71-19"></a>    y=<span class="kw">rnorm</span>(<span class="dv">1</span>,x1,sigma)[<span class="dv">0</span>];</span>
<span id="cb71-20"><a href="#cb71-20"></a>    double u_compare=<span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(y)<span class="op">+</span><span class="kw">abs</span>(x1));</span>
<span id="cb71-21"><a href="#cb71-21"></a>    <span class="cf">if</span>(u[i]<span class="op">&lt;=</span>u_compare )</span>
<span id="cb71-22"><a href="#cb71-22"></a>      {<span class="kw">x.push_back</span>(y);x1=y;}</span>
<span id="cb71-23"><a href="#cb71-23"></a>    <span class="cf">else</span>{</span>
<span id="cb71-24"><a href="#cb71-24"></a>      <span class="kw">x.push_back</span>(x1);</span>
<span id="cb71-25"><a href="#cb71-25"></a>      k=k<span class="op">+</span><span class="dv">1</span>;</span>
<span id="cb71-26"><a href="#cb71-26"></a>    }</span>
<span id="cb71-27"><a href="#cb71-27"></a>  }</span>
<span id="cb71-28"><a href="#cb71-28"></a>  <span class="kw">knum.push_back</span>(k);</span>
<span id="cb71-29"><a href="#cb71-29"></a>  return List<span class="op">::</span><span class="kw">create</span>(</span>
<span id="cb71-30"><a href="#cb71-30"></a>    _[<span class="st">&quot;x&quot;</span>] =<span class="st"> </span>x,</span>
<span id="cb71-31"><a href="#cb71-31"></a>    _[<span class="st">&quot;k&quot;</span>] =<span class="st"> </span>knum</span>
<span id="cb71-32"><a href="#cb71-32"></a>  );</span>
<span id="cb71-33"><a href="#cb71-33"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a><span class="kw">library</span>(Rcpp)</span>
<span id="cb72-2"><a href="#cb72-2"></a><span class="kw">set.seed</span>(<span class="dv">980904</span>)</span>
<span id="cb72-3"><a href="#cb72-3"></a>dir_cpp=<span class="st">&quot;../vignettes/&quot;</span></span>
<span id="cb72-4"><a href="#cb72-4"></a><span class="kw">sourceCpp</span>(<span class="kw">paste0</span>(dir_cpp,<span class="st">&quot;crw.cpp&quot;</span>))</span></code></pre></div>
<pre><code>## Warning in normalizePath(path.expand(path), winslash, mustWork): path[1]=&quot;E:/
## Rpack/StatComp20083/vignettes/../inst/include&quot;: 系统找不到指定的路径。</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a>rw.Metropolis=<span class="cf">function</span>(sigma, x0, N) {</span>
<span id="cb74-2"><a href="#cb74-2"></a>    x=<span class="kw">numeric</span>(N)</span>
<span id="cb74-3"><a href="#cb74-3"></a>    x[<span class="dv">1</span>]=x0</span>
<span id="cb74-4"><a href="#cb74-4"></a>    u=<span class="kw">runif</span>(N)</span>
<span id="cb74-5"><a href="#cb74-5"></a>    k=<span class="dv">0</span></span>
<span id="cb74-6"><a href="#cb74-6"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N){</span>
<span id="cb74-7"><a href="#cb74-7"></a>        y=<span class="kw">rnorm</span>(<span class="dv">1</span>,x[i<span class="dv">-1</span>],sigma)</span>
<span id="cb74-8"><a href="#cb74-8"></a>            <span class="cf">if</span>(u[i]<span class="op">&lt;=</span>((<span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(y)))<span class="op">/</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x[i<span class="dv">-1</span>])))))</span>
<span id="cb74-9"><a href="#cb74-9"></a>                x[i]=y  </span>
<span id="cb74-10"><a href="#cb74-10"></a>            <span class="cf">else</span>{</span>
<span id="cb74-11"><a href="#cb74-11"></a>                x[i]=x[i<span class="dv">-1</span>]</span>
<span id="cb74-12"><a href="#cb74-12"></a>                k=k<span class="op">+</span><span class="dv">1</span></span>
<span id="cb74-13"><a href="#cb74-13"></a>            }</span>
<span id="cb74-14"><a href="#cb74-14"></a>        }</span>
<span id="cb74-15"><a href="#cb74-15"></a>    <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x,<span class="dt">k=</span>k))</span>
<span id="cb74-16"><a href="#cb74-16"></a>}</span>
<span id="cb74-17"><a href="#cb74-17"></a></span>
<span id="cb74-18"><a href="#cb74-18"></a>N=<span class="dv">2000</span></span>
<span id="cb74-19"><a href="#cb74-19"></a>sigma=<span class="kw">c</span>(.<span class="dv">05</span>,.<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">16</span>)</span>
<span id="cb74-20"><a href="#cb74-20"></a></span>
<span id="cb74-21"><a href="#cb74-21"></a>x0=<span class="dv">25</span></span>
<span id="cb74-22"><a href="#cb74-22"></a>rw1=<span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>],x0,N)</span>
<span id="cb74-23"><a href="#cb74-23"></a>rw2=<span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>],x0,N)</span>
<span id="cb74-24"><a href="#cb74-24"></a>rw3=<span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>],x0,N)</span>
<span id="cb74-25"><a href="#cb74-25"></a>rw4=<span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>],x0,N)</span>
<span id="cb74-26"><a href="#cb74-26"></a></span>
<span id="cb74-27"><a href="#cb74-27"></a>crw1=<span class="kw">crw</span>(sigma[<span class="dv">1</span>],x0,N)</span>
<span id="cb74-28"><a href="#cb74-28"></a>crw2=<span class="kw">crw</span>(sigma[<span class="dv">2</span>],x0,N)</span>
<span id="cb74-29"><a href="#cb74-29"></a>crw3=<span class="kw">crw</span>(sigma[<span class="dv">3</span>],x0,N)</span>
<span id="cb74-30"><a href="#cb74-30"></a>crw4=<span class="kw">crw</span>(sigma[<span class="dv">4</span>],x0,N)</span>
<span id="cb74-31"><a href="#cb74-31"></a></span>
<span id="cb74-32"><a href="#cb74-32"></a><span class="co">#number of candidate points rejected</span></span>
<span id="cb74-33"><a href="#cb74-33"></a>no.reject=<span class="kw">data.frame</span>(<span class="dt">sigma=</span>sigma,<span class="dt">no.reject=</span><span class="kw">c</span>(crw1<span class="op">$</span>k,crw2<span class="op">$</span>k,crw3<span class="op">$</span>k,crw4<span class="op">$</span>k))</span>
<span id="cb74-34"><a href="#cb74-34"></a>knitr<span class="op">::</span><span class="kw">kable</span>(no.reject)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">sigma</th>
<th align="right">no.reject</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.05</td>
<td align="right">75</td>
</tr>
<tr class="even">
<td align="right">0.50</td>
<td align="right">609</td>
</tr>
<tr class="odd">
<td align="right">2.00</td>
<td align="right">1210</td>
</tr>
<tr class="even">
<td align="right">16.00</td>
<td align="right">1850</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a>refline=<span class="kw">c</span>(<span class="kw">log</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">20</span>),<span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">20</span>))</span>
<span id="cb75-2"><a href="#cb75-2"></a>rw=<span class="kw">cbind</span>(crw1<span class="op">$</span>x, crw2<span class="op">$</span>x, crw3<span class="op">$</span>x,  crw4<span class="op">$</span>x)</span>
<span id="cb75-3"><a href="#cb75-3"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</span>
<span id="cb75-4"><a href="#cb75-4"></a>    <span class="kw">plot</span>(rw[,j], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb75-5"><a href="#cb75-5"></a>        <span class="dt">xlab=</span><span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(<span class="kw">round</span>(sigma[j],<span class="dv">3</span>))),</span>
<span id="cb75-6"><a href="#cb75-6"></a>        <span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>, <span class="dt">ylim=</span><span class="kw">range</span>(rw[,j]))</span>
<span id="cb75-7"><a href="#cb75-7"></a>    <span class="kw">abline</span>(<span class="dt">h=</span>refline)</span>
<span id="cb75-8"><a href="#cb75-8"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAaVBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6ZpA6ZrY6kNtmAABmADpmOgBmZjpmZrZmtttmtv+QOgCQ2/+2ZgC2Zjq2Zma22/+2/7a2///bkDrbtpDb////tmb/25D//7b//9v///85SQBDAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHYElEQVR4nO2c62KbNgBGlcbuLvG2ro13qVc74f0fchgBBoT4pFhcfc6PxLHFhzgREhiByWAQM3cFlg6CBAgSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIEGMoLfDS/7zbIz59H2s+iyOaEGn5x/XV19Hq9HCiBVUqik0PQSxgi77QtD5YXayxC3IrIZxBF2Td1nVXd8ZNyujCMoKR0+v+UDm8YOgiePGY2JBnV17BZpGEnTKFdhO2jOKPbigU97/vB2uvTSC+nj/9lL8zId4BPVRnWAcn38gqA/bgnKOOwT1UmnJj4YQ1MvJjmF5W0LQPetFkIhDkIhDkIhDkIhDkIhDkIhDkJPC1x1RcQgScQgScQgScQgScQgScQgScQgScQgScQgScQgScQgScQgScQhyUjibj4pDkIhDkIhDkIhDkIhDkIh7XEHv3+xg7p1G/uCCTtX0X+884McWVE+gGphpHx06E6MIatzj47tX47EF0YIU1QQz+iAf9nYWY7x3iz26oMA4BDkpfN0RFYcgEbdtQX9770atuuiBk42tCnr7Uv192Q/cruudP96J26Cgw9Nr8eI4/MyA92+7kLjtCbqepu+uzccIAWcz/ESBzQq6bvrTH6ZsR/eud5OCykaUZr3zGQpdc7yg07UF3f08hc0KykfwXfHTd0N8XNzmBIWOYqHr3Z6gsOOg4PVuTlAT/5F0eNymBX2E7kNVECTiECTiECTielPVqkKq4pbpPCoJQc47CBouszZBq2EuQQOpqlJBLcgpFNOCTO9LscbQglFxA4L8KwzZ0s0LMgPtqLOleUHZ47jveNLLf45R5VSt7qYjqJUeKqj60i2xILMeQb6NaP3uEWQ+KMhMJyhwhpmtSXd7tCA7ujQEORvf3ERnt2lUoP2emUpQ6AyzMEHdVQ8Iqt5qb2JLULmgG9oWFH06HSMoeH5QnyDTEmQ6Ze0Le4BSjXb1K9MSdFvaEWRqbXVdTNndl4LMqIL8M8y6x189h2Wxx3G1oMZbzY8bkVl7sf7inSrO3YKyRju47VzlDtRUmZmb1GqHMFUXXTXE+vO6RLOh1I2q0bO3StySbnlj9UFhM8y6grIeQfUSzUZf7zSDgrLG4j5B2SyCQmeYOd1l3fqFoPKdqgcKFNQIq8e2VpnWjjWqoNA4R1BmGv/A1vj9MUGeTXAGvk4h0/k7fItS4RWUxQvK2oIy0/7RXWe5Cs8Gdd9egKCez3oFOcuYyk05/LSyewQ1V2HWLaj/ZZ+g+qM4Qd29T1Y0YcGoOCWo9a6zzKYFrYa5BA2kBregxod9Z/TDFVh6C4pONc6L+yqwOUHdRe+tAILSpCAo1dpSNez24IAgEYcgEYcgEZc4Nb4CycpFbkrwVY2o1JTMKyj8qkZMalJmFRT1nfRMzCoo+L75RxVEC1LEXNWYiZlHsZirGvPAcVBYBZKV25ygUBAkWOHZ/LSMdBx0E7HU46BQxmlBoffNr4DRTlaD7ptfAWP1QWH3za+AmUex5cOVVcWIghrnrHeGpr2GlfqK2IeKX0GQAEECBAkQdDcIShSKoDTlELTEYh8s/nggSIAgAYIECBIgSIAgAYIECBIgSIAgAYIECBKkF3Q2Q4+lttf3d81ywwsMcfnpe+pIh+SCznnNzv7aXT6/dsqJBQZ4OxRTBVJGuqQWZL+wPnov4VfTY+tyagE/53KOScLIHlILuuyvF+9P3lkgp12nnFrAy9m8WDXpIvtILqho775p1Pn/9ee8v3hplFMLDGGXShrpkFqQ3fW9HcDb4TpB9vhyKycWGF7Z1UHaSIeJBZWFPn1PJyhtpMPUu5gttP+acBdLGukwdSdtC31+TdKjNgUlinSYeJi3dc83LMmYXAhKG+kw9YFiUe28R01yVFeOYikjHdKfapyGD/OP+Zj8tVVOLDBAuYuljHTgZFWAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBGsSZGf9Zpe9nfQ7DSsSVM76PT//yF9OZmg9gspZv3byT6LZUQGsRlA167eeNj4RCxP0/te+eD5U7+NTCkHnT/8ePJ+PwsIEHZ//yS5fPI/SLQSdrjuafBpfOpYlqJyf+mvxx7F82ljtwgp6SjiFNYBlCbLb/fZbfzdjBdkbWPbDjytMxyIFHfq3vuyDWnf4jM6yBFk1ZfPo38VskUfdxbLz0595D+x54Hl5c0/+qX5KWDIWJij773djfhkaxYojxscd5pcHggQIEiBIgCABggQIEiBIgCABggQIEiBIgCABggQIEiBIgCABggQIEiBIgCABggQIEiBI8D/Y3MuZOTEp5wAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a>a=<span class="kw">c</span>(.<span class="dv">05</span>, <span class="kw">seq</span>(.<span class="dv">1</span>, <span class="fl">.9</span>, <span class="fl">.1</span>), <span class="fl">.95</span>)</span>
<span id="cb76-2"><a href="#cb76-2"></a>Q=<span class="kw">c</span>(<span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>a[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>]),<span class="op">-</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>a[<span class="dv">7</span><span class="op">:</span><span class="dv">11</span>])))</span>
<span id="cb76-3"><a href="#cb76-3"></a>rw=<span class="kw">cbind</span>(crw1<span class="op">$</span>x, crw2<span class="op">$</span>x, crw3<span class="op">$</span>x, crw4<span class="op">$</span>x)</span>
<span id="cb76-4"><a href="#cb76-4"></a>mc=rw[<span class="dv">501</span><span class="op">:</span>N, ]</span>
<span id="cb76-5"><a href="#cb76-5"></a>Qrw=<span class="kw">apply</span>(mc, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="kw">quantile</span>(x, a))</span>
<span id="cb76-6"><a href="#cb76-6"></a>qq=<span class="kw">data.frame</span>(<span class="kw">round</span>(<span class="kw">cbind</span>(Q, Qrw), <span class="dv">3</span>))</span>
<span id="cb76-7"><a href="#cb76-7"></a><span class="kw">names</span>(qq)=<span class="kw">c</span>(<span class="st">&#39;True&#39;</span>,<span class="st">&#39;sigma=0.05&#39;</span>,<span class="st">&#39;sigma=0.5&#39;</span>,<span class="st">&#39;sigma=2&#39;</span>,<span class="st">&#39;sigma=16&#39;</span>)</span>
<span id="cb76-8"><a href="#cb76-8"></a>knitr<span class="op">::</span><span class="kw">kable</span>(qq)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">True</th>
<th align="right">sigma=0.05</th>
<th align="right">sigma=0.5</th>
<th align="right">sigma=2</th>
<th align="right">sigma=16</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">5%</td>
<td align="right">-2.303</td>
<td align="right">-0.077</td>
<td align="right">-0.650</td>
<td align="right">-1.486</td>
<td align="right">-2.000</td>
</tr>
<tr class="even">
<td align="left">10%</td>
<td align="right">-1.609</td>
<td align="right">-0.060</td>
<td align="right">-0.479</td>
<td align="right">-1.000</td>
<td align="right">-1.469</td>
</tr>
<tr class="odd">
<td align="left">20%</td>
<td align="right">-0.916</td>
<td align="right">-0.041</td>
<td align="right">-0.242</td>
<td align="right">-0.208</td>
<td align="right">-1.000</td>
</tr>
<tr class="even">
<td align="left">30%</td>
<td align="right">-0.511</td>
<td align="right">-0.024</td>
<td align="right">-0.087</td>
<td align="right">0.000</td>
<td align="right">0.000</td>
</tr>
<tr class="odd">
<td align="left">40%</td>
<td align="right">-0.223</td>
<td align="right">-0.010</td>
<td align="right">0.000</td>
<td align="right">0.000</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">50%</td>
<td align="right">0.000</td>
<td align="right">0.000</td>
<td align="right">0.000</td>
<td align="right">0.000</td>
<td align="right">0.000</td>
</tr>
<tr class="odd">
<td align="left">60%</td>
<td align="right">0.223</td>
<td align="right">0.009</td>
<td align="right">0.000</td>
<td align="right">0.000</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">70%</td>
<td align="right">0.511</td>
<td align="right">0.022</td>
<td align="right">0.030</td>
<td align="right">0.000</td>
<td align="right">0.000</td>
</tr>
<tr class="odd">
<td align="left">80%</td>
<td align="right">0.916</td>
<td align="right">0.037</td>
<td align="right">0.187</td>
<td align="right">0.368</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">90%</td>
<td align="right">1.609</td>
<td align="right">0.063</td>
<td align="right">0.421</td>
<td align="right">1.000</td>
<td align="right">0.673</td>
</tr>
<tr class="odd">
<td align="left">95%</td>
<td align="right">2.303</td>
<td align="right">0.082</td>
<td align="right">0.600</td>
<td align="right">1.618</td>
<td align="right">1.086</td>
</tr>
</tbody>
</table>
<p>these are the answer for exercise 9.4 by using Rcpp.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a><span class="kw">qqplot</span>(rw1<span class="op">$</span>x,crw1<span class="op">$</span>x)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAflBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6OgA6Ojo6OpA6kLY6kNtmAABmADpmOpBmZgBmZmZmtttmtv+QOgCQOmaQZgCQkGaQtpCQ2/+2ZgC2kDq2/7a2///bkDrb25Db2//b/7bb/9vb////tmb/25D//7b//9v///+DYNHxAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIbklEQVR4nO2d63qjNhRFmdRO04uddBr3MnTCNI0vvP8LFt1ABsSWQGDh2euHP9uxhLwijg6ygKwkg2S3bkDqUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgQGRB2Wq4laC41cXHuKGgHnTPkYYoqItxIx8XFhS+ay+P7Deq9ywvaK7qYpKZXYyC+pF2GIPcKDccxVxkzS4mX3qXi9yMuNVFpBnA1EvvcpGbEbe6iMgO1LSPgjpkpZ2FUFAb9iBAZj2WFNRFDWEU5KROEfVL73KRmxG3uni00qC5BF0OKhd9eItS3YJk9ZGGfu1dMGQrRbZTT47myaTqlqQ92zCLoMuh1lJsPiZXtyjZEjHovH81T4+OnSxdQdchiD2oTSsNmi0G6S602hjUvPYuGLSZ815tx9F/khdkvfYuGLkdcauLRjsN4qR9i9Zs0GyCikqBDEPFykaxdp44V5D+9KUKQ9tyfYLah2JzDvOXQxWi1yaoHYLmTRTzzcf6BDWP7ac+Jf2oE8V8uz5BV7NBYwRd/sUfNlqqdGhlgsr2j4XhglTwrUT94ZrKKJtU+nJYmaAIPag6fKjGqEqBc64nrLq0iBKD1GyY4yArvLqk0CuDrDe8S1rPhaFX5yeDq0uJdho0SlCeZb8f3MehodWlRGb6kP2Od1FFNTKJvet4lzGoE4LGCHpRXWdwFPOvLi1aP4qVnO64Rh2oXrUtWFAuYk99sD6+KZNKz0TWmQ0KFySO08tj9XB6nGQoWUFlOUmQTKMvB5FL55OGsXsVlF+t0p+QKyYpqDNjX47oQTu1h91lD+rM2JfhMSh/eFN7mPMHHY8WpDon3c2Cxoxi6rec4h6PxaIIitqWxOgcqZYUdEXnSLWkIJvukWpJQTZ9ISh8mG/Gobs7mu9Mt6o3vUtLnJPMwY1JkPaEfdnzerCwQGVBUdqSGlF6kMgQJ862hm13QWLEoGgkKagnDaIgi740iIIaetOgcZP2OEyvcSF5bwga04N0LiTnPBysciF57yA2fhc7790J0UqXAfelQSMFiU400IPWuZA8Wg86PaLDjHX2oFgxaGjfMqxyIXlvGjRqF6u6EBrH1riQvDcNGhuki/v74bA/DZpnFBuoJd1J+/4QNEaQ+W3szuaDuusW1Nve5c2TKrwM5Yih1SVDfwgaIcgaw114zDsmJ6hn3YJ637sC88TKAp3geccUBZWRRjFXcmwD5x0TFNQ6i8W8712BeVLvP4Oe0LxjcoLixaA4JCfIEYIoyOBIg0YJEgtfxi3uGLHdpeg/lh+XKMoDLHPKxuj2pEbvbNCUYd5nMPOoLhXi9SCTKLrOBAusLhUixiA12XN6nBSE0hPUOxs0ej5oeM4+rLo0cKRBHOY1jtkgCjK4QhAFaVyDGAUZXNOcFKRwTgQvLCjZOWnGIAAFAVLZxeaqbjoM0sNwmAcwBgHYgxCO+TIK0rAHASgIwDwIUN/Lp/MH7xoitiZ+dZPhLgagIIBj6QIFGRikh3Etn/rOBWXXLLmL+Z3tk6XGlO8dJMjvbB/9W92trVgsJcjvXI3mVnnJsJQg99k+dlu+Y0Fr7UGTvndgDPI52ye1GDTte4eNYn5n+9zWhyTe977HPMiHmwlaDTcS5F/1rf4a+o0pCEBBAAoCUBCAggAUBKAgAAUBVnNscCsoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQIKYguThG/uRa2OeXH31ONm/Klvbtc8LKqt81zbU1vMpCIgq6HKr2FKJ94uoNR9M48eSIWtqUFSXqX24Dy55+tD7qVRYTUZC6NVklR95KyVysSq14yMElU+qypewHWlBoWXvNiV9ZTPQYZP5pRpD91f3KFps/taDQsoWlI6TsENEF5bpJhRalur3fNWVk2aqAiUGhZfOfm0AWUnaI2IL0wphj3VDVK7yCgSwrdg0jKLDseS/K5bvQsoNEFnSsx5DLQX1L/4aqsmJpVrigZrum06QpyF5Ypdvm3dVVWfnx4F3M3q6+jWWSu9jV7dtMQz2DZVFnUJIxZfV21VifYpA2K/RU2/Q/z3O4LewLNOZBw/yk7UKi5kF2Jlyv+PRK2K4vfJUHJYrWduV9UEO2i4koSO8dok252klULlR4pPxW2dIIHlE2eLsYHqwCKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAiwIkHnF9dFeeZkBYJOT3K5Rm6tE16Q9AXp23PnD19fvj1Ou5f5GJIXdFRXbTw9vla7WO689NVsJCbo/PxX9umnrb7jbeXjmO2OjaBSrRmTC7EXIjVBYqGqWMcpVs7rNVhSUPWHdylIvOm6Bt8cJCdop9aG5Z83H3q1oVpTJ24wuFUvvz5PXxflTXKCXuXD+fnvpzezoFcvxBSnqsh1h9nkhYcBpCiozHenX96fv+gVmLWgKkiLp+iG3HFJUlCx+Wdb5r8erm+NWwkSO93l8Hny2t4AkhR0evqtisQ/6JObpKAqLlWC5Bkrm/8OCyaMSQo678USXnNSVDOKve+38hPT18/7k6QgeepOvfxZ6ZCnFW7tJcLLkJigIXiwmiQUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoC/A9MehfmzKloygAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a><span class="kw">qqplot</span>(rw2<span class="op">$</span>x,crw2<span class="op">$</span>x)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a><span class="kw">qqplot</span>(rw3<span class="op">$</span>x,crw3<span class="op">$</span>x)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a><span class="kw">qqplot</span>(rw4<span class="op">$</span>x,crw4<span class="op">$</span>x)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Now, We only calculate the time when sigma=2.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a><span class="kw">library</span>(microbenchmark)</span>
<span id="cb81-2"><a href="#cb81-2"></a>N=<span class="dv">2000</span></span>
<span id="cb81-3"><a href="#cb81-3"></a>x0=<span class="dv">25</span></span>
<span id="cb81-4"><a href="#cb81-4"></a>ts &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">rw3=</span><span class="kw">rw.Metropolis</span>(<span class="dv">2</span>,x0,N),<span class="dt">crw3=</span><span class="kw">crw</span>(<span class="dv">2</span>,x0,N))</span>
<span id="cb81-5"><a href="#cb81-5"></a><span class="kw">summary</span>(ts)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##   expr      lq median      uq
## 1  rw3 4980.65 6148.1 7320.55
## 2 crw3  320.45  347.4  427.80</code></pre>
<p>We can see that crw3 significantly faster than rw.Metropolis. Although I wasn’t familiar with this package, c++ produced much better results with consistent algorithms.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
